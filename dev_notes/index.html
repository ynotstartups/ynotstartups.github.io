
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="..">
      
      
        <link rel="next" href="../digital-garden/">
      
      
      <link rel="icon" href="../images/favicon.webp">
      <meta name="generator" content="mkdocs-1.6.0, mkdocs-material-9.5.27">
    
    
      
        <title>Software Engineering Notes - Tiger's Digital Garden</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.6543a935.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../stylesheets/extra.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    <body dir="ltr">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#software-engineering-notes" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="Tiger&#39;s Digital Garden" class="md-header__button md-logo" aria-label="Tiger's Digital Garden" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Tiger's Digital Garden
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Software Engineering Notes
            
          </span>
        </div>
      </div>
    </div>
    
    
      <script>var media,input,key,value,palette=__md_get("__palette");if(palette&&palette.color){"(prefers-color-scheme)"===palette.color.media&&(media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']"),palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent"));for([key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="Tiger&#39;s Digital Garden" class="md-nav__button md-logo" aria-label="Tiger's Digital Garden" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    Tiger's Digital Garden
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Who am I?
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Software Engineering Notes
  </span>
  

      </a>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../digital-garden/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Digital Garden
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../minimalism/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Minimalism
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../recommendations/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Recommendations
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../things-needed-for-travel/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Things Needed
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


<h1 id="software-engineering-notes">Software Engineering Notes</h1>
<h1 id="interview-cheatsheet">Interview Cheatsheet</h1>
<h2 id="on-the-day-of-the-interview">On the day of the Interview</h2>
<ol>
<li>join via video conference app</li>
<li>open up preparation doc</li>
<li>open up CV</li>
<li>open up job description</li>
<li>pen and paper</li>
</ol>
<h2 id="cover-letter">Cover Letter</h2>
<ul>
<li>my name</li>
<li>applying role</li>
<li>why the company stands out to me and what i am a good fit?<ul>
<li>3 bullet points regarding company's industry, value, culture</li>
<li>3 bullet points regarding company's tech</li>
<li>a short self intro</li>
</ul>
</li>
<li>responsibilities in current company<ul>
<li>personal project</li>
<li>personal values</li>
<li>tech stack</li>
</ul>
</li>
<li>HR facts<ul>
<li>contact number &amp; email?</li>
<li>how long is my notice period?</li>
<li>do I need sponsorship to work in the UK?</li>
<li>where am I based?</li>
<li>hybrid, full time or remote?</li>
<li>salary expectation?</li>
</ul>
</li>
</ul>
<h2 id="before-the-interview">Before the Interview</h2>
<h3 id="write-down-basic-facts-about-a-company">Write down basic facts about a company</h3>
<ul>
<li>Link to job description?</li>
<li>What is the company mission?</li>
<li>What does the company do?</li>
<li>How many people?</li>
<li>How is the work life balance like in the company?</li>
<li>What is the tech stack?</li>
<li>What is the tech infrastructure?</li>
<li>Is there a github account?</li>
<li>Checkout the glassdoor comments for the company</li>
<li>What is the name and responsibility of role?</li>
<li>What is culture like in the company?</li>
<li>What is work life balance in the company?</li>
<li>Look for software engineer job description for employees in Linkedin</li>
<li>What is income structure of the company?</li>
<li>What is future of the company?</li>
<li>What is the interview process?</li>
<li>Who are the interviewer?</li>
</ul>
<h3 id="prepare-for-questions">Prepare for questions</h3>
<p><strong>Q: What change job now?</strong></p>
<ul>
<li>no growth in dev team</li>
<li>non-tech company</li>
<li>management too busy to do 1-on-1</li>
</ul>
<p><strong>Q: What interests you about the company?</strong> (<strong>Q: Why do you want to work here?</strong></p>
<ul>
<li>culture</li>
<li>tech stack</li>
</ul>
<p><strong>Q: What do you know about us?</strong></p>
<p><strong>Q: What makes you a good fit for the role?</strong></p>
<p><strong>Q: Tell me about yourself</strong></p>
<ul>
<li>continuous learning and adapting</li>
<li>communications and trust</li>
<li>high software engineering standard</li>
<li>in other words, thoughtful engineer, reliability, scalability, maintainability</li>
</ul>
<p><strong>Q: How to improve online testing code</strong></p>
<ul>
<li>refactor</li>
<li>tests</li>
<li>logging</li>
<li>error handling</li>
<li>horizontal scaling</li>
</ul>
<p><strong>Q: Strengths/Weaknesses</strong></p>
<p><strong>Q: What is the hardest thing you've had to do during your career?</strong></p>
<h2 id="during-the-interview">During the Interview</h2>
<ul>
<li>be confident</li>
<li>remember that the interviewers want me get the job</li>
</ul>
<p><strong>Answer Questions Based On My Personal Values</strong></p>
<ol>
<li>Continuous learnings</li>
<li>open communications and feedbacks</li>
<li>High software engineering standards</li>
<li>unit tests, test coverage, code review, QA, documentations, Typing Hinting, continuous refactoring</li>
</ol>
<p><strong>How to Behave</strong></p>
<ul>
<li>don't make assumption and ask questions early</li>
<li>be assertive and open-minded at the same time</li>
<li>think out loud - communications</li>
<li>understand the problem (ask for clarification, boundary conditions, corner cases ...)</li>
<li>break down to sub questions</li>
<li>open to suggestions and to learn</li>
</ul>
<h2 id="prepare-five-reverse-questions">Prepare Five Reverse Questions</h2>
<p><strong>Interviewer</strong></p>
<ul>
<li>What keeps you in this company? What do you like about it?</li>
</ul>
<p><strong>Role</strong></p>
<ul>
<li>Can you describe a typical projects that I will be involved in? for example, the current project that you are working on</li>
<li>Which team will I work in? What are the responsibilities of the team?</li>
<li>What is your management style?</li>
<li>What will be the ideal person for this role?</li>
</ul>
<p><strong>Company</strong></p>
<ul>
<li>How do you describe the company value?</li>
<li>What is the growth of the company? and what is the future of the company?</li>
<li>How would you pitch your team to convince me to join your team?</li>
<li>what are you competitors? What makes the company competitive in the field?</li>
</ul>
<h1 id="cheatsheet-vim">Cheatsheet Vim</h1>
<h2 id="reminders">Reminders</h2>
<ul>
<li><code>gsp</code> - motion pending operator to change anything to param style <code>foo=foo</code></li>
<li><code>/foo/;/bar</code> - search the first <code>bar</code> after <code>foo</code></li>
</ul>
<h1 id="cheatsheet-vim-regular-expression">Cheatsheet Vim - Regular Expression</h1>
<h3 id="reminders_1">Reminders</h3>
<ul>
<li><code>\zs</code>, <code>ze</code>, modify the start or end of regex match, can make replacing or
  searching easier<ul>
<li>e.g. <code>\zs</code> can replace positive look behind<code>@&lt;=</code></li>
<li>e.g. <code>\ze</code> can replace positive look ahead <code>@=</code></li>
</ul>
</li>
<li><code>\_.</code> matches all characters and <strong>end of line</strong>, useful for multiline matching<ul>
<li><code>.</code> matches all characters but not end of line</li>
</ul>
</li>
<li><code>\w</code> matches word characters, same as <code>[0-9A-Za-z_]</code></li>
<li><code>\s</code> matches space or tab</li>
<li><code>\{-}</code> non-greedy match, match as little as possible, this is a multi<ul>
<li>basically the non-greedy version of <code>*</code></li>
</ul>
</li>
</ul>
<p><strong>Intresting Examples</strong></p>
<ul>
<li><code>\(def\s\)\@&lt;!foo_function(\_.\{-})</code> matches function usage and params
  single line or multi lines, but <strong>not</strong> the function definition </li>
<li><code>def\s\w*(\zs\_.\{-}\ze)</code> matches only params in function definitions,
  single line or multi lines</li>
</ul>
<h3 id="definition-of-a-pattern-in-vim">Definition of a pattern in vim</h3>
<ul>
<li><strong>atom</strong>: <code>a</code> an ordinary character, <code>\i</code> a character class, <code>\(foo\)</code>
  putting <strong>pattern</strong> in parenthesis making it an atom</li>
<li><strong>piece</strong>: <strong>atom</strong> + <strong>multi</strong>, <code>*</code>, <code>\{n,m}</code>, <code>{-}</code><ul>
<li>special <strong>multi</strong>, look ahead <code>\@=</code>, <code>\@!</code>, look behind <code>\@&lt;=</code>,<code>\@&lt;!</code>, </li>
</ul>
</li>
<li><strong>concat</strong>: <strong>piece</strong> + <strong>piece</strong>, <code>a*b*</code></li>
<li><strong>branch</strong>: <strong>concat</strong> <code>\&amp;</code> <strong>concat</strong>, <code>\&amp;</code> means matching both regex
  patterns, like <em>AND</em></li>
<li><strong>pattern</strong>: <strong>branch</strong> <code>\|</code> <strong>branch</strong>, <code>\|</code> means either patterns, like
  <em>OR</em></li>
</ul>
<h1 id="cheatsheet-rg">Cheatsheet Rg</h1>
<table>
<thead>
<tr>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td><code>-F, --fixed-strings</code></td>
<td>Fixed String Matches</td>
</tr>
<tr>
<td><code>-t py</code></td>
<td>select only python files</td>
</tr>
<tr>
<td><code>-w, --word-regexp</code></td>
<td>Word Regexp</td>
</tr>
<tr>
<td><code>-f, --file PATTERNFILE</code></td>
<td>search for all patterns,  one pattern per line</td>
</tr>
<tr>
<td><code>-s</code></td>
<td>case sensitive</td>
</tr>
<tr>
<td><code>-i</code></td>
<td>case insensitive</td>
</tr>
<tr>
<td><code>-S</code></td>
<td>smart case</td>
</tr>
<tr>
<td><code>-g "**/tests/**"</code></td>
<td>search only tests files with glob</td>
</tr>
<tr>
<td><code>-g "!**/tests/**"</code></td>
<td>don't search test files with inverse glob <code>!</code></td>
</tr>
<tr>
<td><code>--stats</code></td>
<td>number of matches, number of line matches</td>
</tr>
<tr>
<td><code>--sort created/modified</code></td>
<td>sort results by file created/modified time</td>
</tr>
<tr>
<td><code>-p, --pretty</code></td>
<td><code>rg -p foo | less</code>, pipe color to other program</td>
</tr>
</tbody>
</table>
<h2 id="multi-lines-matching">Multi lines matching</h2>
<p><strong>Find Python Function Definitions and Usages</strong></p>
<div class="highlight"><pre><span></span><code># this prints Definitions too because I don&#39;t know how to ignore lines
# starts with `def`
# 
# [^,] for removing imports

rg --multiline --multiline-dotall &#39;foo_function_name\(.*?\)[^,]&#39; -g &quot;!**/tests**&quot;
</code></pre></div>
<h2 id="search-for-different-casing">Search For Different Casing</h2>
<p><code>foo_?bar</code> searches for <code>foo_bar</code>, <code>FOO_BAR</code>, <code>FOOBAR</code>, <code>fooBar</code></p>
<p>it works because</p>
<ol>
<li><code>_?</code> means <code>_</code> is optional, i.e. the searched words can contain 0 or 1 <code>_</code></li>
<li>The search is case insensitive by default</li>
</ol>
<h2 id="copy-rg-result-into-pasteboard-for-pr-description">Copy Rg result into pasteboard for PR description...</h2>
<p><code>rg foo --heading --line-number | pbcopy</code></p>
<p>Example output below</p>
<div class="highlight"><pre><span></span><code>dev_notes.md
65:## Usage Example Of curo_request_kwargs
67:`_curo_request`
</code></pre></div>
<h1 id="cheatsheet-regular-expression">Cheatsheet Regular Expression</h1>
<table>
<thead>
<tr>
<th></th>
<th>Rg</th>
<th>Vim</th>
</tr>
</thead>
<tbody>
<tr>
<td>zero or more</td>
<td><code>?</code></td>
<td><code>\?</code></td>
</tr>
<tr>
<td>1 or more</td>
<td><code>+</code></td>
<td><code>\+</code></td>
</tr>
<tr>
<td>precise number of matches</td>
<td><code>{n,m}</code></td>
<td><code>\{n,m}</code></td>
</tr>
<tr>
<td>word boundary</td>
<td><code>\b</code></td>
<td><code>\&lt; \&gt;</code></td>
</tr>
<tr>
<td>multiple patterns or</td>
<td><code>|</code></td>
<td><code>\|</code></td>
</tr>
<tr>
<td>non greedy</td>
<td><code>.*?</code></td>
<td><code>.\{-}</code></td>
</tr>
<tr>
<td>line starts with</td>
<td><code>^</code></td>
<td><code>^</code></td>
</tr>
<tr>
<td>line ends with</td>
<td><code>$</code></td>
<td><code>$</code></td>
</tr>
<tr>
<td>group</td>
<td><code>( )</code></td>
<td><code>\( \)</code></td>
</tr>
<tr>
<td>back reference</td>
<td>not supported</td>
<td><code>\1 \2 \3</code></td>
</tr>
</tbody>
</table>
<h2 id="matches-different-suffixes">matches different suffixes</h2>
<p>Example: to match <code>company</code> and <code>companies</code></p>
<ul>
<li>vim: <code>compan\(y\|ies\)</code> </li>
<li>rg: <code>compan(y|ies)</code></li>
</ul>
<h1 id="cheatsheet-writings">Cheatsheet Writings</h1>
<p>Scrupulous writers, in every sentence that they write, will ask themselves at least four questions:</p>
<ol>
<li>What am I trying to say?</li>
<li>What words will express it?</li>
<li>What image or idiom will make it clearer?</li>
<li>Is this image fresh enough to have an effect?</li>
</ol>
<p>Two more that they may ask are:</p>
<ol>
<li>Could I put it more shortly?</li>
<li>Have I said anything that is avoidably ugly?</li>
</ol>
<p>Consequently there are ways to write well. The following rules will cover most cases:</p>
<ol>
<li>Never use a metaphor, simile or other figure of speech which you are used to seeing in print.</li>
<li>Never use a long word where a short one will do.</li>
<li>If it is possible to cut a word out, always cut it out.</li>
<li>Never use the passive where you can use the active.</li>
<li>Never use a foreign phrase, a scientific word or a jargon word if you can think of an everyday English equivalent.</li>
<li>Break any of these rules sooner than say anything outright barbarous.</li>
</ol>
<h1 id="cheatsheet-software-engineering">Cheatsheet Software Engineering</h1>
<h2 id="give-consistent-code-review">Give Consistent Code Review</h2>
<ul>
<li>add <code>doc string</code> if there is anything unclear</li>
<li>understand <strong>all</strong> code and tests added/modified</li>
<li>handle network and other errors gracefully?</li>
<li>read and test my comments carefully</li>
<li>add ideas about incremental improvements</li>
</ul>
<h2 id="behavioral-personal-growth">Behavioral - Personal growth</h2>
<ul>
<li>There is No Such Thing as Over Communication!</li>
<li>Look for opportunity for incremental improvement</li>
<li>Read documentation/manual/user’s guide before using a new tool/cli<ul>
<li>this implies prefer using tool with good doc e.g. <code>fish</code> instead <code>bash</code></li>
</ul>
</li>
<li>Be more curious about how things work internally</li>
<li>Be prepared because I am bad at ac-hoc talk and thinking<ul>
<li>ask for agenda for meetings so that I can be prepared</li>
</ul>
</li>
<li>Validate assumptions earlier</li>
<li>For meetings,<ul>
<li>gather questions before meeting</li>
<li>set out the purpose of the meetings</li>
<li>write meeting minutes and action points</li>
</ul>
</li>
</ul>
<h2 id="documentations-building-structures-with-natural-language">Documentations - Building structures with natural language</h2>
<ul>
<li>Write non-code How To, repeatable steps for public or personal, e.g.<ul>
<li>How-To deploy UAT</li>
<li>How-To add a graphql endpoint </li>
</ul>
</li>
<li>Write code comments, documentations before implementation <ul>
<li>remember the 4 types of documentation, Tutorial, How-To Step by Step Guides,
  Explanation, Reference</li>
</ul>
</li>
<li>Present tense and full sentence</li>
</ul>
<h2 id="design-writing-good-code">Design - Writing good code</h2>
<ul>
<li>Design it twice<ul>
<li>write down two designs, each with pros and cons, then perhaps there will
  appear a third design with combined pros and less cons</li>
</ul>
</li>
<li>Architect great design rather than just working codes, then writing comments
  should be fun since that’s how you identify the best design</li>
<li>reduce complexity by adding or removing abstraction</li>
<li>Design Goal: reliable, scalable, maintainable</li>
</ul>
<h1 id="cheatsheet-cheatsheet">Cheatsheet cheatsheet</h1>
<p><strong>Best Practices</strong></p>
<ol>
<li>Keep cheatsheet and TIL one page long (after render to pdf)</li>
<li>Consider if I should print them out</li>
</ol>
<h1 id="cheatsheet-django">Cheatsheet Django</h1>
<h2 id="best-practices">Best Practices</h2>
<ul>
<li><code>models</code> field<ul>
<li>use <code>help_text</code> as documentation</li>
<li>use <code>unique=True</code> is this field must be unique throughout the table </li>
</ul>
</li>
</ul>
<h2 id="q-f">Q &amp; F</h2>
<ul>
<li><code>Q()</code> - represents an SQL condition that can be used in database-related
  operations</li>
<li><code>F()</code> - represents the value of a model field or annotation</li>
</ul>
<p>These two make it possible to define and reuse conditions.</p>
<h1 id="cheatsheet-serverless">Cheatsheet Serverless</h1>
<ul>
<li>deploy - <code>sls deploy</code></li>
<li>package to local directory for inspection <ul>
<li><code>serverless package --package ./package-with-azure-upload</code> </li>
</ul>
</li>
</ul>
<h2 id="inspect-package-size">inspect package size</h2>
<div class="highlight"><pre><span></span><code>sls<span class="w"> </span>package<span class="w"> </span>--package<span class="w"> </span>./package-with-azure-upload
<span class="nb">cd</span><span class="w"> </span>package-with-azure-upload
unzip<span class="w"> </span>oneview-serverless.zip<span class="w"> </span>-d<span class="w"> </span>./unzipped
du<span class="w"> </span>-h<span class="w"> </span>-d<span class="w"> </span><span class="m">1</span><span class="w"> </span>./unzipped<span class="w"> </span><span class="p">|</span><span class="w"> </span>sort<span class="w"> </span>--human-numeric-sort
</code></pre></div>
<h1 id="cheatsheet-python">Cheatsheet Python</h1>
<h2 id="a-decorator-to-figure-out-the-order-of-how-functions-or-methods-are-called">a decorator to figure out the order of how functions or methods are Called</h2>
<div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">print_function_name</span><span class="p">(</span><span class="n">func</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">_print_function_name</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;--&gt; begin:  </span><span class="si">{</span><span class="n">func</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">func</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;--&gt; return: </span><span class="si">{</span><span class="n">func</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">result</span>
    <span class="k">return</span> <span class="n">_print_function_name</span>
</code></pre></div>
<h2 id="ipython-autoload">ipython autoload</h2>
<p>reload modules when user executes code, so that I don't need to exit ipython
shell to reload edited code.</p>
<div class="highlight"><pre><span></span><code>%load_ext autoreload
%autoreload 2
</code></pre></div>
<h1 id="cheatsheet-postgres">Cheatsheet Postgres</h1>
<table>
<thead>
<tr>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td><code>\l</code></td>
<td>list databases</td>
</tr>
<tr>
<td><code>\c DATABASE NAME</code></td>
<td>connect/switch to database</td>
</tr>
<tr>
<td><code>\dt</code></td>
<td>list tables</td>
</tr>
<tr>
<td><code>\d TABLE NAME</code></td>
<td>describe table</td>
</tr>
<tr>
<td><code>\o FILE NAME</code> <code>\o</code></td>
<td>save query result to a file</td>
</tr>
<tr>
<td><code>\! shell command</code></td>
<td>run external shell command</td>
</tr>
</tbody>
</table>
<p>You can do <code>\l</code> to list all the databases, use <code>\c</code> to connect to one database,
use <code>\d</code> to list tables in this database</p>
<h2 id="drop-column">Drop column</h2>
<div class="highlight"><pre><span></span><code>ALTER TABLE oneview_frozencharge DROP COLUMN product_fee_charge_is_user_input_required;
</code></pre></div>
<h2 id="rename-table">rename table</h2>
<div class="highlight"><pre><span></span><code>ALTER TABLE oneview_incomeprofile RENAME COLUMN business_unit_id TO adviser_business_unit_id;
ALTER TABLE oneview_incomeprofile RENAME COLUMN adviser_business_unit_id TO business_unit_id;
</code></pre></div>
<h2 id="save-query-result-to-a-file">save query result to a file</h2>
<div class="highlight"><pre><span></span><code># start
\o data.txt

# ...run the psql commands...e.g. \dt

# ended
\o
</code></pre></div>
<div class="highlight"><pre><span></span><code>docker-compose --file docker-compose-dev.yml exec postgres cat data.txt
</code></pre></div>
<h1 id="cheatsheet-bookmarklet">Cheatsheet Bookmarklet</h1>
<div class="highlight"><pre><span></span><code>document.querySelectorAll(&quot;.pr-toolbar&quot;).forEach(el =&gt; el.remove());
</code></pre></div>
<p>https://caiorss.github.io/bookmarklet-maker/</p>
<div class="highlight"><pre><span></span><code><span class="c1">// print PR</span>
<span class="nb">document</span><span class="p">.</span><span class="nx">querySelectorAll</span><span class="p">(</span><span class="s2">&quot;.pr-toolbar&quot;</span><span class="p">).</span><span class="nx">forEach</span><span class="p">(</span><span class="nx">e</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">e</span><span class="p">.</span><span class="nx">remove</span><span class="p">());</span>
<span class="nb">window</span><span class="p">.</span><span class="nx">scrollTo</span><span class="p">(</span><span class="mf">0</span><span class="p">,</span><span class="w"> </span><span class="mf">0</span><span class="p">);</span>
<span class="nb">window</span><span class="p">.</span><span class="nx">location</span><span class="p">.</span><span class="nx">href</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">document</span><span class="p">.</span><span class="nx">URL</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s1">&#39;?diff=unified&amp;w=0&#39;</span><span class="p">;</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="c1">// print fish shell doc</span>
<span class="nb">document</span><span class="p">.</span><span class="nx">querySelectorAll</span><span class="p">(</span><span class="s1">&#39;.sphinxsidebar&#39;</span><span class="p">).</span><span class="nx">forEach</span><span class="p">(</span><span class="nx">e</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">e</span><span class="p">.</span><span class="nx">remove</span><span class="p">())</span>
<span class="nb">document</span><span class="p">.</span><span class="nx">querySelectorAll</span><span class="p">(</span><span class="s1">&#39;.bodywrapper&#39;</span><span class="p">).</span><span class="nx">forEach</span><span class="p">(</span><span class="nx">e</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">e</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">marginLeft</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;0&quot;</span><span class="p">)</span>
</code></pre></div>
<h1 id="cheatsheet-vim9script">Cheatsheet vim9script</h1>
<h2 id="vim9script-examples">vim9script examples</h2>
<h3 id="vim-function-and-variable-var">vim function and variable <code>var</code></h3>
<div class="highlight"><pre><span></span><code># vim9script reminder
# use `var` <span class="k">to</span> <span class="nb">define</span> variable<span class="p">,</span> instead of `<span class="k">let</span>`

# boolean
true
false

# <span class="k">option</span> value &amp;foo 
echo &amp;<span class="k">number</span>
# assigns value <span class="k">to</span> <span class="k">option</span>
&amp;<span class="k">number</span> <span class="p">=</span> <span class="m">1</span>

# contents of <span class="k">register</span> `<span class="k">q</span>`
echo @<span class="k">q</span>
# remove or <span class="k">set</span> contents of <span class="k">register</span> `<span class="k">q</span>`
@<span class="k">q</span> <span class="p">=</span> <span class="s2">&quot;&quot;</span>
# <span class="k">set</span> <span class="k">register</span> <span class="k">q</span> <span class="k">in</span> linewise <span class="k">mode</span>
setreg<span class="p">(</span><span class="s1">&#39;q&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;V&#39;</span><span class="p">)</span>

# string concatenation
var foo <span class="p">=</span> <span class="s2">&quot;abc&quot;</span> .. <span class="s2">&quot;def&quot;</span>
# string interpolation
var name <span class="p">=</span> <span class="s2">&quot;tiger&quot;</span>
echo $<span class="s2">&quot;hello {name}!&quot;</span>

# setting variable name <span class="k">to</span> <span class="k">register</span>
# @<span class="m">0</span> <span class="k">is</span> last yanked text
var name <span class="p">=</span> @<span class="m">0</span>

# <span class="nb">list</span>
var foo_list <span class="p">=</span> [<span class="m">1</span><span class="p">,</span> <span class="m">2</span><span class="p">,</span> <span class="m">3</span>]
var first_item <span class="p">=</span> foo_list[<span class="m">0</span>]
var first_two_items <span class="p">=</span> foo_list[<span class="m">0</span> : <span class="m">2</span>]
var last_two_items <span class="p">=</span> foo_list[<span class="m">-2</span> : ]
# <span class="nb">list</span> concatenation
var foo_list_extended <span class="p">=</span> foo_list <span class="p">+</span> [<span class="m">4</span><span class="p">,</span> <span class="m">5</span>] 
# builtin <span class="nb">list</span> methods
mylist<span class="p">-&gt;</span>add<span class="p">(</span>val1<span class="p">)-&gt;</span>add<span class="p">(</span>val2<span class="p">)</span>
mylist<span class="p">-&gt;</span>copy<span class="p">()</span>
mylist<span class="p">-&gt;</span>count<span class="p">(</span>val<span class="p">)</span>
mylist<span class="p">-&gt;</span>empty<span class="p">()</span>
mylist<span class="p">-&gt;</span>extend<span class="p">(</span>otherlist<span class="p">)</span>
mylist<span class="p">-&gt;</span>filter<span class="p">(</span>expr2<span class="p">)</span>
mylist<span class="p">-&gt;</span>flatten<span class="p">()</span>
mylist<span class="p">-&gt;</span>foreach<span class="p">(</span>expr2<span class="p">)</span>
mylist<span class="p">-&gt;</span>indexof<span class="p">(</span>expr<span class="p">)</span>
mylist<span class="p">-&gt;</span>insert<span class="p">(</span>item<span class="p">)</span>
mylist<span class="p">-&gt;</span><span class="k">join</span><span class="p">()</span>
mylist<span class="p">-&gt;</span>len<span class="p">()</span>
mylist<span class="p">-&gt;</span>map<span class="p">(</span>expr2<span class="p">)</span>
mylist<span class="p">-&gt;</span>max<span class="p">()</span>
mylist<span class="p">-&gt;</span>min<span class="p">()</span>
mylist<span class="p">-&gt;</span>remove<span class="p">(</span>idx<span class="p">)</span>
mylist<span class="p">-&gt;</span>repeat<span class="p">(</span>count<span class="p">)</span>
mylist<span class="p">-&gt;</span>reverse<span class="p">()</span>
mylist<span class="p">-&gt;</span><span class="k">sort</span><span class="p">()</span>
mylist<span class="p">-&gt;</span>string<span class="p">()</span>
mylist<span class="p">-&gt;</span>type<span class="p">()</span>
mylist<span class="p">-&gt;</span>uniq<span class="p">()</span>

# <span class="nb">dictionary</span>
var foo <span class="p">=</span> {<span class="s2">&quot;a&quot;</span>: <span class="m">1</span><span class="p">,</span> <span class="s2">&quot;b&quot;</span>: <span class="m">2</span><span class="p">,</span> <span class="s2">&quot;c&quot;</span>: <span class="m">3</span>}
<span class="k">echomsg</span> foo[<span class="s2">&quot;a&quot;</span>]
<span class="k">for</span> [<span class="nb">key</span><span class="p">,</span> value] <span class="k">in</span> foo<span class="p">-&gt;</span>items<span class="p">()</span>
    <span class="k">echomsg</span> <span class="nb">key</span> value
<span class="k">endfor</span>
# <span class="nb">dictionary</span> methods
mydict<span class="p">-&gt;</span>has_key<span class="p">(</span><span class="nb">key</span><span class="p">)</span>
mydict<span class="p">-&gt;</span>items<span class="p">()</span>
mydict<span class="p">-&gt;</span>keys<span class="p">()</span>
mydict<span class="p">-&gt;</span>values<span class="p">()</span>

# <span class="k">if</span>
var <span class="k">a</span> <span class="p">=</span> <span class="m">1</span>.<span class="m">5</span>
<span class="k">if</span> <span class="k">a</span> <span class="p">&gt;</span> <span class="m">2</span>
    echo <span class="s2">&quot;a &gt; 2&quot;</span> <span class="k">a</span>
<span class="k">elseif</span> <span class="k">a</span> <span class="p">&gt;</span> <span class="m">1</span>
    echo <span class="s2">&quot;a &gt; 1&quot;</span> <span class="k">a</span>
<span class="k">else</span>
    echo <span class="s2">&quot;a &lt; 1&quot;</span> <span class="k">a</span>
<span class="k">endif</span>

# <span class="k">for</span> loop
var foo <span class="p">=</span> [<span class="m">1</span><span class="p">,</span> <span class="m">2</span><span class="p">,</span> <span class="m">3</span>]
<span class="k">for</span> <span class="k">i</span> <span class="k">in</span> foo
    echo <span class="k">i</span>
<span class="k">endfor</span>

# regex <span class="k">match</span><span class="p">,</span> <span class="k">right</span> hand side string <span class="k">is</span> used <span class="k">as</span> <span class="k">a</span> pattern
# echo true
echo <span class="s2">&quot;foo&quot;</span> <span class="p">=~</span> <span class="s1">&#39;^f.*&#39;</span>
# echo false
echo <span class="s2">&quot;foo&quot;</span> <span class="p">=~</span> <span class="s1">&#39;b.*&#39;</span>

# powerful commands

# execute the string from the evaluation of {expr1} <span class="k">as</span> an cli # command
execute <span class="s2">&quot;normal @q&quot;</span>

# calling <span class="k">vim</span> builtin <span class="k">function</span><span class="p">,</span> see `:help builtin.txt`
# see help <span class="k">for</span> builtin <span class="k">function</span> `substitute` at `:help substitude<span class="p">()</span>`
var remove_prefix <span class="p">=</span> substitute<span class="p">(</span>posix_file_path<span class="p">,</span> <span class="s1">&#39;^saltus/&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;g&#39;</span><span class="p">)</span>

# Types

float<span class="p">,</span> string<span class="p">,</span> bool<span class="p">,</span> <span class="k">number</span><span class="p">,</span> float<span class="p">,</span> string<span class="p">,</span> blob<span class="p">,</span> <span class="nb">list</span><span class="p">&lt;</span>type<span class="p">&gt;,</span> <span class="nb">dict</span><span class="p">&lt;</span>type<span class="p">&gt;,</span> job<span class="p">,</span>
channel<span class="p">,</span> func
</code></pre></div>
<h3 id="example-function-implementation">Example function implementation</h3>
<div class="highlight"><pre><span></span><code><span class="nb">def</span> GetWordAfterPrefix<span class="p">(</span>prefix_string: string<span class="p">)</span>: string
  # search <span class="k">for</span> the line <span class="k">number</span> and column <span class="k">number</span> <span class="k">for</span> the prefix_string
  # <span class="k">e</span>.<span class="k">g</span>. the line and column of character <span class="s1">&#39;f&#39;</span> <span class="k">in</span> `<span class="nb">def</span> \zsfoo` 
  # flag `<span class="k">b</span>` <span class="p">-</span> search backward  
  # flag `<span class="k">n</span>` <span class="p">-</span> <span class="k">do</span> not move the cursor
  # see also `:help search<span class="p">()</span>`
  var [match_line_number<span class="p">,</span> match_col_number] <span class="p">=</span> <span class="p">(</span>prefix_string .. <span class="s1">&#39;\zs&#39;</span><span class="p">)-&gt;</span>searchpos<span class="p">(</span><span class="s1">&#39;bn&#39;</span><span class="p">)</span>
  var line <span class="p">=</span> getline<span class="p">(</span>match_line_number<span class="p">)</span>
  # get the word with matching column position <span class="p">-</span> <span class="m">1</span><span class="p">,</span> `<span class="m">-1</span>` <span class="k">is</span> needed <span class="k">to</span> <span class="nb">include</span>
  # the <span class="k">first</span> character of the word<span class="p">,</span> <span class="k">e</span>.<span class="k">g</span>. word would be `foo`
  var word <span class="p">=</span> line<span class="p">-&gt;</span>matchstr<span class="p">(</span><span class="s1">&#39;\w*&#39;</span><span class="p">,</span> match_col_number <span class="p">-</span> <span class="m">1</span><span class="p">)</span>
  <span class="k">return</span> word
enddef

<span class="nb">def</span> <span class="k">g</span>:YankWordAfterPrefix<span class="p">(</span>prefix_string: string<span class="p">)</span>
  var word <span class="p">=</span> GetWordAfterPrefix<span class="p">(</span>prefix_string<span class="p">)</span>
  <span class="k">echom</span> <span class="s1">&#39;yanked&#39;</span> word
  setreg<span class="p">(</span><span class="s1">&#39;+&#39;</span><span class="p">,</span> word<span class="p">)</span>
enddef

<span class="nb">nnoremap</span> <span class="p">&lt;</span>leader<span class="p">&gt;</span>yf :<span class="k">call</span> YankWordAfterPrefix<span class="p">(</span><span class="s2">&quot;def &quot;</span><span class="p">)&lt;</span><span class="k">cr</span><span class="p">&gt;</span>
<span class="nb">nnoremap</span> <span class="p">&lt;</span>leader<span class="p">&gt;</span>yc :<span class="k">call</span> YankWordAfterPrefix<span class="p">(</span><span class="s2">&quot;class &quot;</span><span class="p">)&lt;</span><span class="k">cr</span><span class="p">&gt;</span>

<span class="nb">def</span> GetPythonFileImportPath<span class="p">()</span>: string
    var posix_file_path <span class="p">=</span> expand<span class="p">(</span><span class="s2">&quot;%&quot;</span><span class="p">)</span>
    var python_import_path <span class="p">=</span> posix_file_path
                                <span class="p">-&gt;</span>substitute<span class="p">(</span><span class="s1">&#39;^saltus/&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;g&#39;</span><span class="p">)</span>
                                <span class="p">-&gt;</span>substitute<span class="p">(</span><span class="s1">&#39;.py$&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;g&#39;</span><span class="p">)</span>
                                <span class="p">-&gt;</span>substitute<span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">,</span> <span class="s1">&#39;.&#39;</span><span class="p">,</span> <span class="s1">&#39;g&#39;</span><span class="p">)</span>
    <span class="k">return</span> python_import_path
enddef
</code></pre></div>
<h3 id="using-python-in-vim">Using python in vim</h3>
<div class="highlight"><pre><span></span><code><span class="nb">def</span> <span class="k">g</span>:JumpToTestFile<span class="p">()</span>
<span class="k">py3</span> <span class="p">&lt;&lt;</span> EOF
from vim_python import get_or_create_alternative_file

# <span class="k">vim</span>.eval<span class="p">(</span><span class="s2">&quot;@%&quot;</span><span class="p">)</span> gets the filepath <span class="k">in</span> current buffer
test_filepath <span class="p">=</span> get_or_create_alternative_file<span class="p">(</span>filepath<span class="p">=</span><span class="k">vim</span>.eval<span class="p">(</span><span class="s2">&quot;@%&quot;</span><span class="p">))</span>

# open test_filepath <span class="k">in</span> current <span class="nb">window</span>
<span class="k">vim</span>.command<span class="p">(</span><span class="k">f</span><span class="s2">&quot;tabnew {test_filepath}&quot;</span><span class="p">)</span>
EOF
enddef
</code></pre></div>
<h3 id="running-a-vimscript-file-foovim">running a vimscript file foo.vim</h3>
<div class="highlight"><pre><span></span><code>&gt;<span class="w"> </span>cat<span class="w"> </span>foo.vim
vim9script
var<span class="w"> </span><span class="nv">a</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">[</span><span class="m">1</span>,<span class="w"> </span><span class="m">2</span>,<span class="w"> </span><span class="m">3</span><span class="o">]</span>
echomsg<span class="w"> </span>a
&gt;<span class="w"> </span>vim<span class="w"> </span>-S<span class="w"> </span>foo.vim
</code></pre></div>
<h1 id="cheatsheet-terraform">Cheatsheet Terraform</h1>
<h2 id="tf-language-blocks">tf language Blocks</h2>
<ul>
<li><code>terraform</code> - terraform settings and dependent providers</li>
<li><code>provider</code> - configs for the specific provider</li>
<li><code>resource</code> - defines components of the infrastructure, requires 2 strings
  "resource type" and "resource name"</li>
<li><code>variable</code> - defines variables</li>
<li><code>output</code> - use to connect the terraform projects with other poarts of your
  infrastructure or with other terraform projects</li>
</ul>
<h2 id="terraform-cli-commands">terraform cli commands</h2>
<ul>
<li><code>init</code> - initializes a working directory containing Terraform configuration
  files. It is safe to run this command multiple times.</li>
</ul>
<p><strong>Provisioning Infrastructure</strong></p>
<ul>
<li><code>plan</code> - presents a plan for making changes, dry-run of <code>apply</code></li>
<li><code>apply</code> - applies the planned changes to each resource using the relevant
  infrastructure provider's API</li>
<li><code>destroy</code> - destroys all of the resources being managed by the current
  working directory and workspace</li>
</ul>
<p><strong>Inspecting Infrastructure</strong></p>
<ul>
<li><code>graph</code> - creates a visual representation of a configuration or a set of
  planned changes.</li>
<li><code>output</code> - can get the values for the top-level output values of a
  configuration</li>
<li><code>show</code> -  can generate human-readable versions of a state file or plan file,
  or generate machine-readable versions that can be integrated with other
  tools.</li>
</ul>
<p><strong>Developing</strong></p>
<ul>
<li><code>fmt</code> - format</li>
<li><code>validate</code> - validates the configuration files in a directory, referring only
  to the configuration and not accessing any remote services such as remote
  state, provider APIs, etc.</li>
</ul>
<p>See Also: https://developer.hashicorp.com/terraform/cli</p>
<h1 id="book-designing-data-intensive-applications-23may24">Book - Designing Data-Intensive Applications                      - 23/May/24</h1>
<h2 id="acid-atomicity-and-isolation-page-228">ACID, atomicity and isolation, page 228</h2>
<p><strong>Atomicity</strong></p>
<p>If an error occurs halfway through a sequence of writes, the transaction should
be aborted, and the writes made up to that point should be discarded. In other
words, the database saves you from having to worry about partial failure, by
giving an all-or-nothing guarantee.</p>
<p><strong>Isolation</strong></p>
<p>Concurrently running transactions shouldn't interfere with each other. For
example, if one transaction makes several writes, then another transaction
should see either all or none of those writes, but not some subset.</p>
<h2 id="key-feature-of-transaction-page-231">Key feature of transaction, page 231</h2>
<p>A key feature of a transaction is that it can be aborted and safely retried if
an error occurred. ACID databases are based on this philosophy: if the
database is in danger of violating its guarantee of atomicity, isolation, or
durability, it would rather abandon the transaction entirely than allow it to
remain half-finished.</p>
<h2 id="faults-and-partial-failures-page-274">Faults and Partial Failures, page 274</h2>
<p>There is no fundamental reason why software on a single computer should be
flaky: when the hardware is working correctly, the same operation always
produces the same result (it is deterministic). If there is a hardware
problem, the consequence is usually a total system failure.</p>
<p>In a distributed systems, there may well be some parts of the system that are
broken in some unpredictable way, even though other parts of the system are
working fine. This is known as partial failure. The difficulty is that partial
failures are non-deterministic: if you try to do anything involving multiple
nodes and the network, it may sometimes work and sometimes unpredictably fail.</p>
<p>This non-determinism and possibility of partial failures is that makes
distributed systems hard to work with.</p>
<h2 id="why-do-we-need-distributed-system-page-311">Why do we need distributed system?, page 311</h2>
<p>Scalabilty is not the only reason for wanting to use a distributed system.
Fault tolerance and low latency (by placing data geographically close to
users) are equally important goals, and those things can not be achieved with
a single node.</p>
<h2 id="system-models-page-307">System Models, page 307</h2>
<p>we somehow formalize the kinds of faults that we expect to happen in a system.
We do this by defining a system model, which is an abstraction that describes
what things an algorithm may assume.</p>
<h2 id="system-models-regarding-timing-assumptions">System Models regarding timing assumptions</h2>
<p><strong>Synchronous model</strong></p>
<p>The synchronous model assumes bounded network delay, bounded process pauses,
and bounded clock error. This does not imply exactly synchronized clocks or
zero network delay; it just means you know that network delay, pauses, and
clock drift will never exceed some fixed upper bound. The synchronous
model is not a realistic model of most practical systems, because (as
discussed in this chapter) unbounded delays and pauses do occur.</p>
<p><strong>Partially synchronous model</strong> - Realistic Assumption</p>
<p>Partial synchrony means that a system behaves like a synchronous system most
of the time, but it sometimes exceeds the bounds for network delay, process
pauses, and clock drift. This is a realistic model of many systems: most of
the time, networks and processes are quite well behaved—otherwise we would
never be able to get anything done—but we have to reckon with the fact that
any timing assumptions may be shattered occasionally. When this happens,
network delay, pauses, and clock error may become arbitrarily large.</p>
<h2 id="system-models-regarding-node-failures">System Models regarding node failures</h2>
<p><strong>Crash-stop faults</strong></p>
<p>In the crash-stop model, an algorithm may assume that a node can fail in only
one way, namely by crashing. This means that the node may suddenly stop
responding at any moment, and thereafter that node is gone forever—it never
comes back.</p>
<p><strong>Crash-recovery faults</strong> - Realistic Assumption</p>
<p>We assume that nodes may crash at any moment, and perhaps start responding
again after some unknown time. In the crash-recovery model, nodes are assumed
to have stable storage (i.e., nonvolatile disk storage) that is preserved across
crashes, while the in-memory state is assumed to be lost.</p>
<h2 id="definition-of-stream">Definition of Stream</h2>
<p>In general, a "stream" refers to data that is incrementally made available
over time.The concept appears in many places: in the<code>stdin</code> and <code>stdout</code> of
Unix, programming languages (lazy lists), filesystem APIs (such as Java's
<code>FileInputStream</code>)</p>
<h1 id="til-python-set-timeout-in-requests-library-08aug23">TIL - Python: Set Timeout In Requests Library                     - 08/Aug/23</h1>
<div class="highlight"><pre><span></span><code><span class="c1"># timeout = (connect timeout, read timeout)</span>
<span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;https://github.com&#39;</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">27</span><span class="p">))</span>
</code></pre></div>
<blockquote>
<p>By default, requests do not time out unless a timeout value is set
explicitly. Without a timeout, your code may hang for minutes or more.
It’s a good practice to set connect timeouts to slightly larger than a
multiple of 3, which is the default TCP packet retransmission window.
Doc from requests</p>
</blockquote>
<h1 id="til-python-assert-logs-with-python-unittest-08aug23">TIL - Python: Assert Logs With Python Unittest                    - 08/Aug/23</h1>
<div class="highlight"><pre><span></span><code><span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">assertLogs</span><span class="p">(</span><span class="s1">&#39;foo&#39;</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="s1">&#39;INFO&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">cm</span><span class="p">:</span>
    <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="s1">&#39;foo&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;first message&#39;</span><span class="p">)</span>
    <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="s1">&#39;foo.bar&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s1">&#39;second message&#39;</span><span class="p">)</span>
<span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">cm</span><span class="o">.</span><span class="n">output</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;INFO:foo:first message&#39;</span><span class="p">,</span>
                             <span class="s1">&#39;ERROR:foo.bar:second message&#39;</span><span class="p">])</span>
</code></pre></div>
<p>https://docs.python.org/3/library/unittest.html#unittest.TestCase.assertLogs</p>
<h1 id="til-bash-command-env-for-printing-environment-variabls-in-shell-08aug23">TIL - Bash: Command env for printing environment variabls in shell- 08/Aug/23</h1>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>docker<span class="w"> </span>run<span class="w"> </span>ubuntu<span class="w"> </span>env
</code></pre></div>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>env

<span class="nv">PYTHONUNBUFFERED</span><span class="o">=</span><span class="m">1</span>
<span class="nv">CELERY_BROKER_URL</span><span class="o">=</span>amqp://guest:guest@rabbitmq:5672//
<span class="nv">CHOKIDAR_USEPOLLING</span><span class="o">=</span><span class="nb">true</span>
<span class="nv">HOSTNAME</span><span class="o">=</span>af072bc9372e
<span class="nv">PYTHON_VERSION</span><span class="o">=</span><span class="m">3</span>.8.17
<span class="nv">CELERY_RESULT_BACKEND</span><span class="o">=</span>django-db
<span class="nv">PWD</span><span class="o">=</span>/app/backend
<span class="nv">PYTHON_SETUPTOOLS_VERSION</span><span class="o">=</span><span class="m">57</span>.5.0
<span class="nv">HOME</span><span class="o">=</span>/root
<span class="nv">LANG</span><span class="o">=</span>C.UTF-8
<span class="nv">AWS_SECRET_ACCESS_KEY</span><span class="o">=</span>
<span class="nv">ONEVIEW_ENV</span><span class="o">=</span>DEV
<span class="nv">TERM</span><span class="o">=</span>xterm
<span class="nv">SHLVL</span><span class="o">=</span><span class="m">1</span>
<span class="nv">AWS_ACCESS_KEY_ID</span><span class="o">=</span>
<span class="nv">PYTHON_PIP_VERSION</span><span class="o">=</span><span class="m">23</span>.0.1
<span class="nv">PYTHON_GET_PIP_SHA256</span><span class="o">=</span>96461deced5c2a487ddc65207ec5a9cffeca0d34e7af7ea1afc470ff0d746207
<span class="nv">PYTHON_GET_PIP_URL</span><span class="o">=</span>https://github.com/pypa/get-pip/raw/0d8570dc44796f4369b652222cf176b3db6ac70e/public/get-pip.py
<span class="nv">PATH</span><span class="o">=</span>/root/.local/bin:/usr/local/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin
<span class="nv">AWS_SESSION_TOKEN</span><span class="o">=</span>
<span class="nv">_</span><span class="o">=</span>/usr/bin/env
</code></pre></div>
<h1 id="til-git-understanding-git-log-09aug23">TIL - Git: Understanding Git Log                                  - 09/Aug/23</h1>
<ol>
<li>commit object filename/hash <code>5a761fe</code> actually sits in <code>.git/objects/5a/761</code></li>
<li><code>index a871d21e..00000000</code> means <code>file hash before commit..file hash after commit</code><ul>
<li><code>a871d21e</code> is the object representing the file, <code>000000</code> is no index /dev/null, this means deleting a file.</li>
<li>If it's new file it would be <code>00000000..a871d21e</code></li>
<li>If it's change of some file contents, not new or delete, it would be <code>hash..hash</code> e.g. <code>abcs23rr..a871d21e</code></li>
</ul>
</li>
</ol>
<div class="highlight"><pre><span></span><code>commit 5a761fe301ebfe45e0a72d99e619102cba149e6d (HEAD -&gt; ON-1987-tiger-test-remove-aws-credentials, origin/ON-1987-tiger-test-remove-aws-credentials) 
Author: ynotstartups &lt;ynotstartups@gmail.com&gt;
Date:   Tue Aug 8 18:15:54 2023 +0100

    remove not needed configure_aws.sh

    The following environment variables are provided in github action
    aws-actions/configure-aws-credentials@v2 used in docker-compose-dev.yml

diff --git a/.github/configure_aws.sh b/.github/configure_aws.sh
deleted file mode 100644
index a871d21e..00000000
--- a/.github/configure_aws.sh
+++ /dev/null
@@ -1,13 +0,0 @@
-#!/bin/sh
-set -eu
-
-export_aws_credentials () {
-   awsProfile=${AWS_PROFILE:-default}
-   AWS_ACCESS_KEY_ID=$(aws --profile &quot;$awsProfile&quot; configure get aws_access_key_id)
-   AWS_SECRET_ACCESS_KEY=$(aws --profile &quot;$awsProfile&quot; configure get aws_secret_access_key)
-   AWS_SESSION_TOKEN=$(aws --profile &quot;$awsProfile&quot; configure get aws_session_token)
-   export AWS_ACCESS_KEY_ID AWS_SECRET_ACCESS_KEY AWS_SESSION_TOKEN
-
-}
-
-export_aws_credentials
</code></pre></div>
<h1 id="til-bash-resolve-dns-ip-addresses-in-mac-10aug23">TIL - Bash: Resolve DNS ip addresses in Mac                       - 10/Aug/23</h1>
<div class="highlight"><pre><span></span><code>&gt;<span class="w"> </span>dscacheutil<span class="w"> </span>-q<span class="w"> </span>host<span class="w"> </span>-a<span class="w"> </span>name<span class="w"> </span>google.com
name:<span class="w"> </span>google.com
ipv6_address:<span class="w"> </span>2a00:1450:4009:820::200e

name:<span class="w"> </span>google.com
ip_address:<span class="w"> </span><span class="m">142</span>.250.187.238
</code></pre></div>
<div class="highlight"><pre><span></span><code>&gt;<span class="w"> </span>nslookup<span class="w"> </span>google.com
Server:<span class="w">     </span>fe80::1%15
Address:<span class="w">    </span>fe80::1%15#53

Non-authoritative<span class="w"> </span>answer:
Name:<span class="w">   </span>google.com
Address:<span class="w"> </span><span class="m">142</span>.250.187.238
</code></pre></div>
<h1 id="til-python-get-file-path-to-python-source-codes-11aug23">TIL - Python: Get File Path To Python Source Codes                - 11/Aug/23</h1>
<p>in iPython</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="kn">import</span> <span class="nn">requests</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">requests</span><span class="err">??</span>
<span class="o">&gt;&gt;&gt;</span> <span class="kn">import</span> <span class="nn">this</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">this</span><span class="err">??</span>
</code></pre></div>
<h1 id="til-vim-open-errors-in-quickfix-list-for-vim-17aug23">TIL - Vim: Open Errors in Quickfix List For Vim                   - 17/Aug/23</h1>
<ol>
<li>in Vim, run command <code>:cexpr system('command that returns quickfix format')</code></li>
<li>in Terminal, <code>vim -q &lt;(command that returns quickfix error format)</code></li>
</ol>
<p>Example for quickfix format</p>
<div class="highlight"><pre><span></span><code>.<span class="sr">/lambdas/</span>atr_notification/__init__.<span class="k">py</span>:<span class="m">1</span>:<span class="m">1</span>: F401 <span class="s1">&#39;json&#39;</span> imported but unused
.<span class="sr">/lambdas/</span>atr_notification/__init__.<span class="k">py</span>:<span class="m">2</span>:<span class="m">1</span>: F401 <span class="s1">&#39;boto3&#39;</span> imported but unused
.<span class="sr">/lambdas/</span>atr_notification/__init__.<span class="k">py</span>:<span class="m">4</span>:<span class="m">1</span>: F401 <span class="s1">&#39;lambdas.common.config.oneview.SNS_TARGET_ARN&#39;</span> imported but unused
</code></pre></div>
<p>Example quick hack of loading output into vim quickfix</p>
<div class="highlight"><pre><span></span><code><span class="nb">alias</span><span class="w"> </span>,a<span class="o">=</span><span class="s1">&#39;docker compose run --rm serverless python -m mypy run.py lambdas/ tests/ &gt; quickfix.vim ; cat quickfix.vim&#39;</span>
<span class="nb">alias</span><span class="w"> </span>,s<span class="o">=</span><span class="s1">&#39;vim -q quickfix.vim&#39;</span>
</code></pre></div>
<h1 id="til-vim-terminal-color-scheme-25aug23">TIL - Vim: Terminal Color Scheme                                  - 25/Aug/23</h1>
<p>I learn that I should enable my true color support which makes molokai color theme much better to see.</p>
<p><code>set termguicolors</code></p>
<p><strong>Useful links</strong></p>
<p><a href="https://github.com/termstandard/colors">Test your terminal color</a> 
<a href="https://github.com/tomasr/molokai/blob/master/colors/molokai.vim">molokai color scheme</a></p>
<h1 id="til-docker-how-does-docker-use-cache-27aug23">TIL - Docker: How does docker use cache?                          - 27/Aug/23</h1>
<p><strong>Docker uses cache when the following two rules are met.</strong></p>
<ol>
<li>when the docker command is not <code>ADD</code> or <code>COPY</code>, e.g. <code>RUN</code>
    a. given parent image in cache 
    b. look at next instruction
    c. if there is any child image (derived from parents) with the <em>exact same
    instruction use</em> it as cache</li>
<li>For <code>ADD</code> and <code>COPY</code> command, compare checksum of each file with exsiting
   images, if checksum is different then cache is invalidated</li>
</ol>
<h1 id="til-git-git-checkout-27aug23">TIL - Git: git checkout                                           - 27/Aug/23</h1>
<p>Since git version 2.23.0, see <a href="https://github.com/git/git/blob/master/Documentation/RelNotes/2.23.0.txt#L61-L65">changelog</a>,
all functionalities of <code>git checkout</code> is replaced by
<code>git restore</code> and <code>git switch</code>, make <code>git checkout</code> obsolete.</p>
<blockquote>
<p>Two new commands "git switch" and "git restore" are introduced to
split "checking out a branch to work on advancing its history" and
"checking out paths out of the index and/or a tree-ish to work on
advancing the current history" out of the single "git checkout"
command.</p>
</blockquote>
<p>for example,</p>
<p><code>git checkout &lt;commit&gt;</code> is replaced by <code>git switch</code> for </p>
<p><code>git checkout [commit] &lt;paths&gt;</code> is replaced by <code>git restore</code></p>
<h1 id="til-git-git-reset-27aug23">TIL - Git: git reset                                              - 27/Aug/23</h1>
<blockquote>
<p>Reset, restore and revert
   There are three commands with similar names: git reset, git restore and git revert.
   •   git-revert(1) is about making a new commit that reverts the changes made by other commits.
   •   git-restore(1) is about restoring files in the working tree from either the index or another commit. This command does not update your branch. The
       command can also be used to restore files in the index from another commit.
   •   git-reset(1) is about updating your branch, moving the tip in order to add or remove commits from the branch. This operation changes the commit
       history.
   git reset can also be used to restore the index, overlapping with git restore.</p>
</blockquote>
<ul>
<li><code>git reset --soft    &lt;commit&gt;</code> - changes HEAD to point to commit, put changes
  at index</li>
<li><code>git reset [--mixed] &lt;commit&gt;</code> - changes HEAD to point to commit, makes index
  look like HEAD</li>
<li><code>git reset --hard    &lt;commit&gt;</code> - changes HEAD to point to commit, discard
  changes in index and work directory</li>
</ul>
<p>Conclusion, it's still too difficult to understand <code>git reset</code>, hmm, just stay away from <code>git reset</code>.</p>
<p>If I want to change branch, uses <code>git rebase</code> with fixup or squash.</p>
<h1 id="til-vim-vim-man-page-search-for-short-option-27aug23">TIL - Vim: vim man page search for short option                   - 27/Aug/23</h1>
<p>combine <code>/</code> <code>\C</code>  <code>\&lt;</code>  <code>-g</code>  <code>\&gt;</code></p>
<ul>
<li><code>\C</code> to turn on the case sensitivity case</li>
<li><code>\&lt;</code> <code>\&gt;</code> for word search</li>
<li><code>\g</code> example for short option</li>
</ul>
<h1 id="til-vim-dont-use-vim-to-act-as-pager-or-man-page-reader-27aug23">TIL - Vim: don't use vim to act as pager or man page reader       - 27/Aug/23</h1>
<p>Vim doesn't interpret ansi sequences good enough, see the following photo.</p>
<p><img alt="vim-man-page" src="../images/vim-man-page.png" /></p>
<h1 id="til-python-python-wheel-31aug23">TIL - Python: python wheel                                        - 31/Aug/23</h1>
<p><strong>output for installing source distribution (not wheel)</strong></p>
<p>downloading tar.gz and building wheel</p>
<div class="highlight"><pre><span></span><code>&gt; python -m pip install &#39;uwsgi==2.0.*&#39;

Collecting uwsgi==2.0.*
  Downloading uwsgi-2.0.22.tar.gz (809 kB)
     ---------------------------------------- 809.7/809.7 kB 13.4 MB/s eta 0:00:00
  Preparing metadata (setup.py) ... done
Building wheels for collected packages: uwsgi
  Building wheel for uwsgi (setup.py) ... done
  Created wheel for uwsgi: filename=uWSGI-2.0.22-cp311-cp311-macosx_13_0_arm64.whl size=400536 sha256=a79b882b505a3093feed13f859dfa01e1ce04651abd125d418509505bc861d94
  Stored in directory: /Users/yuhao.huang/Library/Caches/pip/wheels/93/59/2d/d21852a9f9607e9494b5d3c96d11f348d11039f7c47223c9ce
Successfully built uwsgi
Installing collected packages: uwsgi
Successfully installed uwsgi-2.0.22
</code></pre></div>
<p><strong>output for installing wheel</strong></p>
<p>there’s no build stage when pip finds a compatible wheel on PyPI.</p>
<div class="highlight"><pre><span></span><code>&gt; python -m pip install &#39;chardet==3.*&#39;
Collecting chardet==3.*
  Downloading chardet-3.0.4-py2.py3-none-any.whl (133 kB)
     ---------------------------------------- 133.4/133.4 kB 4.8 MB/s eta 0:00:00
Installing collected packages: chardet
Successfully installed chardet-3.0.4
</code></pre></div>
<p>A Python .whl file is essentially a ZIP (.zip) archive with a specially crafted
filename that tells installers what Python versions and platforms the wheel will
support.</p>
<p><code>{dist}-{version}(-{build})?-{python}-{abi}-{platform}.whl</code></p>
<p><code>cryptography-2.9.2-cp35-abi3-macosx_10_9_x86_64.whl</code></p>
<h1 id="til-misc-ascii-encoding-02sep23">TIL - Misc: ASCII encoding                                        - 02/Sep/23</h1>
<p><strong>hexadecimal dump of ascii charaters</strong></p>
<p>from <code>man ascii</code></p>
<p>The control characters in ASCII still in common use include:</p>
<ul>
<li><code>0x00 (null, NUL, \0, ^@)</code>, originally intended to be an ignored character,
  but now used by many programming languages including C to mark the end of a
  string.</li>
<li><code>0x07 (bell, BEL, \a, ^G)</code>, which may cause the device to emit a warning such
  as a bell or beep sound or the screen flashing.</li>
<li><code>0x08 (backspace, BS, \b, ^H)</code>, may overprint the previous character.</li>
<li><code>0x09 (horizontal tab, HT, \t, ^I)</code>, moves the printing position right to the
  next tab stop.</li>
<li><code>0x0A (line feed, LF, \n, ^J)</code>, moves the print head down one line, or to the
  left edge and down. Used as the end of line marker in most UNIX systems and
  variants.</li>
<li><code>0x0B (vertical tab, VT, \v, ^K)</code>, vertical tabulation.</li>
<li><code>0x0C (form feed, FF, \f, ^L)</code>, to cause a printer to eject paper to the top
  of the next page, or a video terminal to clear the screen.</li>
<li><code>0x0D (carriage return, CR, \r, ^M)</code>, moves the printing position to the start
  of the line, allowing overprinting. Used as the end of line marker in Classic
  Mac OS, OS-9, FLEX (and variants). A CR+LF pair is used by CP/M-80 and its
  derivatives including DOS and Windows, and by Application Layer protocols such
  as FTP, SMTP, and HTTP.</li>
<li><code>0x1A (Control-Z, SUB, ^Z)</code>, Acts as an end-of-file for the Windows text-mode
  file i/o.</li>
<li>
<p><code>0x1B (escape, ESC, \e (GCC only), ^[)</code>. Introduces an escape sequence.</p>
</li>
<li>
<p>Control characters may be described as doing something when the user inputs
  them, such as code 3 (End-of-Text character, ETX, ^C) to interrupt the running
  process, or code 4 (End-of-Transmission character, EOT, ^D), used to end text
  input on Unix or to exit a Unix shell. These uses usually have little to do
  with their use when they are in text being output.</p>
</li>
</ul>
<p><strong>to see the hex value for characters</strong></p>
<p><code>od -t a -t x1 -t c</code></p>
<ul>
<li><code>-t a</code>  - prints in ascii format</li>
<li><code>-t x1</code> - prints in hex format</li>
<li><code>-t c</code>  - prints in c escape format</li>
</ul>
<p>e.g.</p>
<div class="highlight"><pre><span></span><code>&gt; printf &#39;\0\a\b\n\r\t\v &#39; | od -t a -t x1 -t c
0000000  nul bel  bs  nl  cr  ht  vt  sp
          00  07  08  0a  0d  09  0b  20
          \0  \a  \b  \n  \r  \t  \v
0000010
</code></pre></div>
<p><strong>Understanding the color escape code</strong></p>
<p><code>\033</code> is actually ESC character in ascii octal format,
<code>\e</code> is equivalent in zsh shell, however, don't use <code>\e</code>,
<code>\e</code> is not recognised in <code>awk</code> nor <code>python</code>.</p>
<p><div class="highlight"><pre><span></span><code>&gt; echo &quot;\033[31mRed Text\033[0m&quot;
Red Text
&gt; echo &quot;\e[31mRed Text\e[0m&quot;
Red Text
</code></pre></div>
- <code>\033[</code>  - Begin the color modifications
- <code>CODEm</code> - CODE + <code>m</code> at the end
- <code>\e[0m</code>  - End the color modifications</p>
<table>
<thead>
<tr>
<th>code</th>
<th>description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>30</code></td>
<td>fg black</td>
</tr>
<tr>
<td><code>31</code></td>
<td>fg red</td>
</tr>
<tr>
<td><code>32</code></td>
<td>fg green</td>
</tr>
<tr>
<td><code>33</code></td>
<td>fg brown</td>
</tr>
<tr>
<td><code>34</code></td>
<td>fg blue</td>
</tr>
<tr>
<td><code>35</code></td>
<td>fg purple</td>
</tr>
<tr>
<td><code>36</code></td>
<td>fg cyan</td>
</tr>
<tr>
<td><code>37</code></td>
<td>fg light grey</td>
</tr>
<tr>
<td><code>40</code></td>
<td>bg black</td>
</tr>
<tr>
<td><code>41</code></td>
<td>bg red</td>
</tr>
<tr>
<td><code>42</code></td>
<td>bg green</td>
</tr>
<tr>
<td><code>43</code></td>
<td>bg brown</td>
</tr>
<tr>
<td><code>44</code></td>
<td>bg blue</td>
</tr>
<tr>
<td><code>45</code></td>
<td>bg purple</td>
</tr>
<tr>
<td><code>46</code></td>
<td>bg cyan</td>
</tr>
<tr>
<td><code>47</code></td>
<td>bg light grey</td>
</tr>
<tr>
<td><code>0</code></td>
<td>reset / normal</td>
</tr>
<tr>
<td><code>1</code></td>
<td>bold</td>
</tr>
<tr>
<td><code>3</code></td>
<td>italic</td>
</tr>
<tr>
<td><code>4</code></td>
<td>underline</td>
</tr>
</tbody>
</table>
<div class="highlight"><pre><span></span><code>&gt;<span class="w"> </span><span class="k">for</span><span class="w"> </span>i<span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="o">{</span><span class="m">1</span>..111<span class="o">}</span>
<span class="k">do</span>
<span class="w">    </span><span class="nb">echo</span><span class="w"> </span><span class="s1">&#39;\\e[&#39;</span><span class="nv">$i</span><span class="s1">&#39;m&#39;</span><span class="w"> </span><span class="s2">&quot;\e[</span><span class="si">${</span><span class="nv">i</span><span class="si">}</span><span class="s2">mtext\e[0m&quot;</span>
<span class="k">done</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>column
</code></pre></div>
<p><img alt="bash color" src="../images/bash_color.png" /></p>
<h1 id="til-vim-gq-formatoption-05sep23">TIL - Vim: gq formatoption                                        - 05/Sep/23</h1>
<p>Current formatoption for markdown is <code>formatoption=jtln</code> from <code>set
formatoptions?</code></p>
<pre><code>                        *fo-j*
</code></pre>
<p>j   Where it makes sense, remove a comment leader when joining lines.  For
    example, joining:
        int i;   // the index ~
                 // in the list ~
    Becomes:
        int i;   // the index in the list ~</p>
<pre><code>                        *fo-t*
</code></pre>
<p>t   Auto-wrap text using 'textwidth'</p>
<pre><code>                        *fo-l*
</code></pre>
<p>l   Long lines are not broken in insert mode: When a line was longer than
    'textwidth' when the insert command started, Vim does not
    automatically format it.</p>
<pre><code>                        *fo-n*
</code></pre>
<p>n   When formatting text, recognize numbered lists.  This actually uses
    the 'formatlistpat' option, thus any kind of list can be used.  The
    indent of the text after the number is used for the next line.  The
    default is to find a number, optionally followed by '.', ':', ')',
    ']' or '}'.  Note that 'autoindent' must be set too.  Doesn't work
    well together with "2".
    Example: &gt;
        1. the first item
           wraps
        2. the second item</p>
<h1 id="til-git-vs-05sep23">TIL - Git: .. vs ...                                              - 05/Sep/23</h1>
<h2 id="to-see-the-code-diff-in-feature-branch">To see the code diff in <code>feature</code> branch?</h2>
<div class="highlight"><pre><span></span><code>git<span class="w"> </span>diff<span class="w"> </span>master...feature
</code></pre></div>
<h2 id="to-see-the-commits-added-in-feature-branch">To see the commits added in <code>feature</code> branch?</h2>
<div class="highlight"><pre><span></span><code>git<span class="w"> </span>log<span class="w"> </span>master..feature
</code></pre></div>
<h2 id="explanation-for-git-diff">Explanation for <code>git diff</code></h2>
<p>Use the three dots like this <code>git diff [&lt;options&gt;] &lt;commit&gt;...&lt;commit&gt;</code>.</p>
<div class="highlight"><pre><span></span><code>  B---C---D master (Branch)
 /
A
 \
  H---I feature (Branch)
</code></pre></div>
<p>Two dots - show the diffs between all changes on both sides,
use the <code>git diff master..feature</code>,
output: (diff of <code>H, I</code> against <code>B, C, D</code>)</p>
<p>Three dots - to show the diffs between the last common ancestor (A), aka the
commit we started the feature branch,
use <code>git diff master...feature</code>,
output: (diff of <code>H, I</code> against <code>A</code>).</p>
<h2 id="note-that-and-dont-have-the-same-meaning-in-git-log">Note that ... and .. don't have the same meaning in git log</h2>
<blockquote>
<p>However, "diff" is about comparing two endpoints, not ranges, and the range
notations ("<commit>..<commit>" and "<commit>...<commit>") do not mean a range
as defined in the "SPECIFYING RANGES" section in gitrevisions[7].</p>
<p>from <code>git diff --help</code></p>
</blockquote>
<h2 id="explanation-for-git-log">Explanation for <code>git log</code></h2>
<p>Kind of like reversing the meaning for <code>...</code> and <code>..</code> in <code>git diff</code></p>
<div class="highlight"><pre><span></span><code>git<span class="w"> </span>log<span class="w"> </span>master..feature

<span class="c1"># equivalent to</span>

git<span class="w"> </span>log<span class="w"> </span>^master<span class="w"> </span>feature

<span class="c1"># refers to commit `H and I`</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code>git<span class="w"> </span>log<span class="w"> </span>master...feature

<span class="c1"># equivalent to</span>

git<span class="w"> </span>log<span class="w"> </span>master<span class="w"> </span>feature<span class="w"> </span>--not<span class="w"> </span><span class="k">$(</span>git<span class="w"> </span>merge-base<span class="w"> </span>--all<span class="w"> </span>master<span class="w"> </span>feature<span class="k">)</span>

<span class="c1"># refers to commit `B, C,D, H and I`</span>
</code></pre></div>
<p>See <code>man gitrevision</code> under <code>SPECIFYING RANGES</code> section</p>
<h2 id="see-also">See also</h2>
<p>The <strong>best stack overflow</strong> explanation <a href="https://stackoverflow.com/a/7256391">see here</a></p>
<h1 id="til-misc-thoughts-on-shortcuts-06sep23">TIL - Misc: Thoughts On Shortcuts                                 - 06/Sep/23</h1>
<p>It's not about the most efficient / least keystockes, it's more about making
them suit my own personal way of working.</p>
<h1 id="til-vim-tips-about-fugitive-06sep23">TIL - Vim: Tips about Fugitive                                    - 06/Sep/23</h1>
<ul>
<li><code>:Gedit Head~3:%</code> to load the current file in buffer 3 commits ago, like <code>git
  restore --source=HEAD~3</code> current filename</li>
<li><code>:Gvdiffsplit origin/master:%</code> to see git diff with file in origin/master<ul>
<li>and <code>&lt;ctrl-l&gt;</code> to switch</li>
</ul>
</li>
</ul>
<h1 id="til-vim-some-links-about-mapping-06sep23">TIL - Vim: Some links about mapping                               - 06/Sep/23</h1>
<ul>
<li><code>:verbose nmap ]]</code> - to find out which file that mapping is defined in. From
  there you should be able to figure out which plugin that file is a part of</li>
</ul>
<p>Useful resources on how to do mappings below</p>
<p>https://vim.fandom.com/wiki/Mapping_keys_in_Vim_-<em>Tutorial</em>(Part_2)</p>
<p>https://learnvimscriptthehardway.stevelosh.com/chapters/30.html</p>
<h1 id="til-vim-find-out-vims-python-10sep23">TIL - Vim: Find out vim's python                                  - 10/Sep/23</h1>
<ul>
<li><code>:py3 import os;print(os.__file__)</code> - print path of python<ul>
<li>/opt/homebrew/Cellar/python@3.11/3.11.4_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/os.py</li>
<li>using the system python at the n fmoment</li>
</ul>
</li>
</ul>
<h1 id="til-vim-matches-on-the-second-occurrence-17sep23">TIL - Vim: Matches on the second occurrence                       - 17/Sep/23</h1>
<p>For example, I want to match on the second <code>&lt;</code> of the following line</p>
<div class="highlight"><pre><span></span><code>cnoremap &lt;c-j&gt;   &lt;down&gt;
cnoremap &lt;c-k&gt;   &lt;up&gt;
cnoremap &lt;up&gt;    &lt;nop&gt;
cnoremap &lt;down&gt;  &lt;nop&gt;
cnoremap &lt;left&gt;  &lt;nop&gt;
cnoremap &lt;right&gt; &lt;nop&gt;
</code></pre></div>
<p>Uses pattern <code>&lt;.*\zs&lt;</code></p>
<ul>
<li><code>&lt;</code>   - matches the first <code>&lt;</code></li>
<li><code>.*</code>  - greedy matches everything after</li>
<li><code>\zs</code> - resets the start of the pattern matches (a vim specific pattern)</li>
<li><code>&lt;</code>   - matches the second <code>&lt;</code></li>
</ul>
<p><strong>Bonus:</strong></p>
<p><code>sed -n 's/&lt;.*\(&lt;\)/\1/p'</code>
changes <code>cnoremap &lt;c-j&gt;   &lt;down&gt;</code> to <code>cnoremap &lt;down&gt;</code>,
something like delete the first <code>&lt;&gt;</code></p>
<p><code>sed -n 's/\(&lt;.*\)&lt;.*&gt;/\1/p'</code>
changes <code>cnoremap &lt;c-j&gt;   &lt;down&gt;</code> to <code>cnoremap &lt;c-j&gt;</code>,
something like delete the second <code>&lt;&gt;</code></p>
<h1 id="til-bash-change-date-format-in-bash-17sep23">TIL - Bash: Change date format in bash                            - 17/Sep/23</h1>
<p>TLDR - <code>date -j -f '%d/%b/%y' $INPUT_DATE +%Y-%m-%d</code></p>
<ul>
<li><code>-f</code> takes <code>strftime</code> format string, <code>man strftime</code><ul>
<li>turns out python <code>datetime.strftime</code> also uses the exact same format
  string, because python internally uses standard c library's <code>strftime</code></li>
</ul>
</li>
<li><code>+%Y-%m-%d</code> is the output format</li>
<li><code>-j</code> do not try to set the date, this allows the usage of <code>-f</code> and <code>+</code> to
  convert one date format to another</li>
</ul>
<h1 id="til-vim-how-to-print-manual-page-in-color-17sep23">TIL - Vim: How to print manual page in color                      - 17/Sep/23</h1>
<ol>
<li>Use <code>Vim</code> with <code>:Man</code>, you will need <code>runtime ftplugin/man.vim</code></li>
<li>open man page with <code>:Man date</code></li>
<li>In zshrc <code>export MANWIDTH=80</code>, this sets the width to 80 so that the man
   page can fit in one page with correct paragraph indent</li>
<li><code>:TOhtml</code> (P.S. I have my own <code>:TOPrintHtml</code>)</li>
<li>then open with web browser and print</li>
</ol>
<h1 id="til-python-get-celery-ran-tasks-27sep23">TIL - Python: Get celery ran tasks                                - 27/Sep/23</h1>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">django_celery_results.models</span> <span class="kn">import</span> <span class="n">TaskResult</span>
<span class="kn">from</span> <span class="nn">pprint</span> <span class="kn">import</span> <span class="n">pprint</span>

<span class="c1"># get tasks by recency</span>
<span class="n">task_result</span> <span class="o">=</span> <span class="n">TaskResult</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">order_by</span><span class="p">(</span><span class="s1">&#39;-date_created&#39;</span><span class="p">)[:</span><span class="mi">5</span><span class="p">]</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">task_result</span><span class="p">:</span>
    <span class="n">pprint</span><span class="p">(</span><span class="nb">vars</span><span class="p">(</span><span class="n">i</span><span class="p">))</span>

<span class="c1"># get failed tasks</span>
<span class="n">task_result</span> <span class="o">=</span> <span class="n">TaskResult</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">status</span><span class="o">=</span><span class="s1">&#39;FAILURE&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">order_by</span><span class="p">(</span><span class="s1">&#39;date_done&#39;</span><span class="p">)[:</span><span class="mi">10</span><span class="p">]</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">task_result</span><span class="p">:</span>
    <span class="n">pprint</span><span class="p">(</span><span class="nb">vars</span><span class="p">(</span><span class="n">i</span><span class="p">))</span>
</code></pre></div>
<h1 id="til-bash-man-page-vs-books-29sep23">TIL - Bash: Man Page v.s. Books                                   - 29/Sep/23</h1>
<p>Manual page, such as <code>man awk</code>, is a good reference manual, but reading it is
not a good way of learning, to learn, a beginner book from O'Reilly is much
better.</p>
<h1 id="til-bash-cups-and-epson-et-2810-printer-30sep23">TIL - Bash: CUPS and Epson ET-2810 Printer                        - 30/Sep/23</h1>
<p>TL;DR: <code>lpr -p -o EPIJ_Silt=1 -o Resolution=720x720dpi -o EPIJ_Qual=307 ./lpoptoins.pdf</code></p>
<p>Use <code>lpoptions -l</code> to show custom options for printer, such as <code>EPIJ_Qual/Print
Quality: 308 311 *303 309 304 305 306 307</code>.</p>
<p>Note that only <code>EPIJ_Qual</code> is used in printing option e.g. <code>lpr -o
EPIJ_Qual=308</code>, the text after <code>/</code> is an short description of the option.</p>
<p>Example output of <code>lpoptions -l</code></p>
<div class="highlight"><pre><span></span><code>$ lpoptions -l
...
EPIJ_Ink_/Grayscale: *1 0
EPIJ_Qual/Print Quality: 308 311 *303 309 304 305 306 307
ColorModel/ColorModel: *RGB Mono
Resolution/Resolution: 180x180dpi *360x360dpi 720x720dpi
PageSize/Media Size: *A4 EPKG EPKG.NMgn EPPhotoPaper2L A6 A5 B5 B6 EPPhotoPaperLRoll EPPhotoPaperLRoll.NMgn EPIndexCard5x8 EP8x10in EPHiVision102x180 EPHiVision102x180.NMgn EPPostcard100x148 EPPostcard100x148.NMgn Env10 EnvDL EnvC6 Letter EP216x330mm EPIndianLegal Legal EP16K195x270mm Custom.WIDTHxHEIGHT
EPIJ_Silt/Quiet Mode: *0 1
...
</code></pre></div>
<p>upzip <code>/Library/Printers/PPDs/Contents/Resources/EPSON\ ET-2810\ Series.gz</code> to
<code>~/Documents/downloads/</code> read the mearning of options.</p>
<p>Run the following command in the unzipped <code>downloads</code> folder
<div class="highlight"><pre><span></span><code>$ cat EPSON\ ET-2820\ Series | grep Qua
...
*EPIJ_Qual 308/Draft: &quot;&quot;
*EPIJ_Qual 311/Draft-Vivid : &quot;&quot;
*EPIJ_Qual 303/Normal: &quot;&quot;
*EPIJ_Qual 309/Normal-Vivid: &quot;&quot;
*EPIJ_Qual 304/Fine: &quot;&quot;
*EPIJ_Qual 305/Quality: &quot;&quot;
*EPIJ_Qual 306/High Quality: &quot;&quot;
*EPIJ_Qual 307/Best Quality: &quot;&quot;
...
</code></pre></div></p>
<p>Other Useful Links: </p>
<ul>
<li>local Cups link: http://localhost:631/<ul>
<li>logins with laptops's username and password</li>
</ul>
</li>
<li><code>/private/etc/cups/ppd</code><ul>
<li>printer ppd file - Postscript Printer Description file is a file that describes the font s, paper sizes, resolution , and other capabilities that are standard for a particular Postscript printer</li>
</ul>
</li>
</ul>
<h1 id="til-bash-search-source-code-in-certain-directories-only-01oct23">TIL - Bash: Search source code in certain directories only        - 01/Oct/23</h1>
<p>Question: How to exclude *.tsx, migrations files, and python tests files?</p>
<h2 id="in-git-grep">In git grep</h2>
<div class="highlight"><pre><span></span><code>git<span class="w"> </span>grep<span class="w"> </span><span class="s1">&#39;tiger&#39;</span><span class="w"> </span>--<span class="w"> </span><span class="s1">&#39;*.py&#39;</span><span class="w"> </span><span class="s1">&#39;:!*tests*&#39;</span><span class="w"> </span><span class="s1">&#39;:!*migrations*&#39;</span>
<span class="c1"># same as </span>
git<span class="w"> </span>grep<span class="w"> </span><span class="s1">&#39;tiger&#39;</span><span class="w"> </span>--<span class="w"> </span><span class="s1">&#39;*.py&#39;</span><span class="w"> </span><span class="s1">&#39;:(exclude)*tests*&#39;</span><span class="w"> </span><span class="s1">&#39;:(exclude)*migrations*&#39;</span>
</code></pre></div>
<p>After the <code>--</code> the patterns used are <code>&lt;pathspec&gt;</code>, see <code>man gitglossary</code>.</p>
<h2 id="in-rg">In Rg</h2>
<div class="highlight"><pre><span></span><code>rg<span class="w"> </span><span class="s1">&#39;tiger&#39;</span><span class="w"> </span>--glob<span class="w"> </span><span class="s1">&#39;!{**/tests/*,**/migrations/*}&#39;</span>

<span class="c1"># if you are sure there are no files with name `tests` or `migations`, you</span>
<span class="c1"># can do</span>
rg<span class="w"> </span><span class="s1">&#39;tiger&#39;</span><span class="w"> </span>--glob<span class="w"> </span><span class="s1">&#39;!{tests,migrations}&#39;</span>

rg<span class="w"> </span><span class="s1">&#39;tiger&#39;</span><span class="w"> </span>-g<span class="w"> </span><span class="s1">&#39;!tests&#39;</span><span class="w"> </span>-g<span class="w"> </span><span class="s1">&#39;!migrations&#39;</span>
</code></pre></div>
<h1 id="til-bash-shell-builtin-commands-and-busybox-01oct23">TIL - Bash: Shell builtin commands and Busybox                    - 01/Oct/23</h1>
<p>Certain shell commands are builtin to <code>zsh</code>, others are exposed in PATH.
<code>echo</code> is a shell built-in command
<code>cat</code> is exposed in PATH.</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>which<span class="w"> </span><span class="nb">echo</span>
echo:<span class="w"> </span>shell<span class="w"> </span>built-in<span class="w"> </span><span class="nb">command</span>

$<span class="w"> </span>which<span class="w"> </span>cat
/bin/cat
</code></pre></div>
<h2 id="what-is-busybox">What is BusyBox?</h2>
<blockquote>
<p>BusyBox combines tiny versions of many common UNIX utilities into a single
small executable.  It provides minimalist replacements for most of the
utilities you usually find in bzip2, coreutils, dhcp, diffutils, e2fsprogs,
file, findutils, gawk, grep, inetutils, less, modutils, net-tools, procps,
sed, shadow, sysklogd, sysvinit, tar, util-linux, and vim.  The utilities
in BusyBox often have fewer options than their full-featured cousins;
however, the options that are included provide the expected functionality
and behave very much like their larger counterparts.</p>
</blockquote>
<p>BusyBox seems useful to</p>
<ol>
<li>read the C Implementation of the shell utilities</li>
<li>use as sandbox as a simpler environment compared in MacOS</li>
</ol>
<h2 id="implementation-of-shell-command-cat-in-c">Implementation of shell command <code>cat</code> in <code>C</code></h2>
<p>https://github.com/mirror/busybox/blob/master/coreutils/cat.c</p>
<h2 id="play-with-busybox">Play with busybox</h2>
<p><code>docker run -it --rm busybox</code></p>
<div class="highlight"><pre><span></span><code>/bin # ls -l | wc -l
406
</code></pre></div>
<p>There are 406 utilities in busybox /bin, whereas MacOS has 980 in <code>/usr/bin</code>.</p>
<h1 id="til-bash-bash-find-out-the-size-of-current-directory-03oct23">TIL - Bash: bash find out the size of current directory           - 03/Oct/23</h1>
<p><code>du -d 1 -h | sort --human-numeric-sort --reverse | head</code></p>
<p>worth noting that</p>
<ul>
<li>sort has this option <code>--human-numeric-sort</code> specifically for human output
  i.e. <code>du -h</code></li>
</ul>
<h1 id="til-misc-authentication-vs-authorization-05oct23">TIL - Misc: Authentication vs Authorization                       - 05/Oct/23</h1>
<p>Authentication is the process of verifying that "you are who you say you are"</p>
<p>Authorization is the process of verifying that "you are permitted to do what
you are trying to do"</p>
<h1 id="til-vim-vim-extract-table-of-content-07oct23">TIL - Vim: Vim Extract Table of Content                           - 07/Oct/23</h1>
<div class="highlight"><pre><span></span><code>ZSHMISC(1)                   General Commands Manual                  ZSHMISC(1)
NAME
       zshmisc - everything and then some
SIMPLE COMMANDS &amp; PIPELINES
       A simple command is a sequence of optional parameter assignments followed
       ...
PRECOMMAND MODIFIERS
       A simple command may be preceded by a precommand modifier, which will
       ...
</code></pre></div>
<p>I would like the extract a Table of Content from manual page such as below</p>
<div class="highlight"><pre><span></span><code>SIMPLE COMMANDS &amp; PIPELINES
PRECOMMAND MODIFIERS
</code></pre></div>
<ol>
<li><code>:redir @a</code>  - setup redirect to register <code>a</code></li>
<li><code>:g/^\u.*/p</code> - find all lines start with upper case and print them </li>
<li><code>:redir END</code> - end the redirection</li>
<li><code>"ap</code>        - paste content in register a </li>
</ol>
<h1 id="til-python-find-the-dependencies-of-python-package-19oct23">TIL - Python: Find the dependencies of python package             - 19/Oct/23</h1>
<p>Two ways</p>
<ol>
<li>Go into a shell with the dependencies installed</li>
</ol>
<p><div class="highlight"><pre><span></span><code><span class="n">In</span> <span class="p">[</span><span class="mi">1</span><span class="p">]:</span>  <span class="kn">from</span> <span class="nn">importlib.metadata</span> <span class="kn">import</span> <span class="n">requires</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">2</span><span class="p">]:</span> <span class="n">requires</span><span class="p">(</span><span class="s1">&#39;Django&#39;</span><span class="p">)</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">2</span><span class="p">]:</span>
<span class="p">[</span><span class="s1">&#39;asgiref (&lt;4,&gt;=3.3.2)&#39;</span><span class="p">,</span>
 <span class="s1">&#39;pytz&#39;</span><span class="p">,</span>
 <span class="s1">&#39;sqlparse (&gt;=0.2.2)&#39;</span><span class="p">,</span>
 <span class="s2">&quot;argon2-cffi (&gt;=19.1.0) ; extra == &#39;argon2&#39;&quot;</span><span class="p">,</span>
 <span class="s2">&quot;bcrypt ; extra == &#39;bcrypt&#39;&quot;</span><span class="p">]</span>
 <span class="err">```</span>

 <span class="mf">2.</span> <span class="n">Read</span> <span class="n">the</span> <span class="n">poetry</span><span class="o">.</span><span class="n">lock</span> <span class="n">file</span> 
</code></pre></div>
[[package]]
name = "django"
version = "3.2.20"
description = "A high-level Python Web framework that encourages rapid development and clean, pragmatic design."
optional = false
python-versions = "&gt;=3.6"
files = [
    {file = "Django-3.2.20-py3-none-any.whl", hash = "sha256:a477ab326ae7d8807dc25c186b951ab8c7648a3a23f9497763c37307a2b5ef87"},
    {file = "Django-3.2.20.tar.gz", hash = "sha256:dec2a116787b8e14962014bf78e120bba454135108e1af9e9b91ade7b2964c40"},
]</p>
<p>[package.dependencies]
asgiref = "&gt;=3.3.2,&lt;4"
pytz = "*"
sqlparse = "&gt;=0.2.2"</p>
<p>[package.extras]
argon2 = ["argon2-cffi (&gt;=19.1.0)"]
bcrypt = ["bcrypt"]
<div class="highlight"><pre><span></span><code># TIL - Docker: 137 exit code                                       - 16/Aug/23

TLDR: Exit code 137 is caused by `oneview-django-1` container exited

1. mostly likely caused by migration file in the PR conflicting with migration
   files in master branch.
2. if there is no migration, it could be some other error causing
   `oneview-django-1` exits,
   such as `TypeError: check_permissions() got an  unexpected keyword argument &#39;groups&#39;`

&lt;img width=&quot;388&quot; alt=&quot;Screenshot 2023-08-16 at 18 26 41&quot; src=&quot;https://github.com/Saltus-Partners/oneview/assets/13963732/7e36c2b5-5782-4eb8-9ee2-c147c489cb61&quot;&gt;

**First of all, Exit code 137 doesn&#39;t necessarily mean out of memory issue.**

Based on [Advanced Bash-Scripting Guide Exit Code](https://tldp.org/LDP/abs/html/exitcodes.html), in the example of 128 + n , 137 exit code means a process receives Fatal Error Signal 9, i.e. `kill -9`, from `man kill`, kill with signal 9 is `KILL (non-catchable, non-ignorable kill)`.

**The actual reason of exit code 137**

This PR, contains the minimal changes to demonstrate/reproduce the exit code 137, the changes are
1. added migration file
2. in github action, use `sleep 999`  to replace other actions such as install dev dependencies, lint, tests ...

In the github action, we use [actions/checkout@v3](https://github.com/actions/checkout), which under the hood, checkout a **merge** PR with `origin/master` branch.

In this PR, we have a migration file `0185_task_retain_regarding.py`, and in master branch we have additional migration files `0185_auto_20230814_1357.py` and `0186_providercontact_status.py`, because github action checkout creates the merge PR, then in the github action running environment, we have all three of these migration files. 

Because of these conflicting migrations files, the `oneview-django-1` container constantly exits with error `CommandError: Conflicting migrations detected; multiple leaf nodes in the migration graph: (0185_task_retain_regarding, 0186_providercontact_status in oneview).` 

&lt;img width=&quot;1530&quot; alt=&quot;Screenshot 2023-08-16 at 18 20 21&quot; src=&quot;https://github.com/Saltus-Partners/oneview/assets/13963732/3e448c9e-dfe0-4cfe-8fb9-6129fce8d859&quot;&gt;

Then in the bash sleep step `docker compose --file docker-compose-dev.yml exec django sleep 999`,
the `/bin/sleep` is running within the container, but the container gets killed, then this sleep process exited with 137.

To confirm the above finding is correct, I managed to reproduce the exit code 137 locally. 
To reproduce,  you can run `make run-be` in the first terminal window, and run `make bash` in the second terminal window, then you quick input 3 &lt;ctrl-c&gt; in the first terminal to force kill the oneview-django-1 container, the container will get a `SIGKILL` i.e. `kill -9` that&#39;s why the process exited with exit code 137.

&lt;img width=&quot;733&quot; alt=&quot;Screenshot 2023-08-16 at 18 14 50&quot; src=&quot;https://github.com/Saltus-Partners/oneview/assets/13963732/edf8bb12-3814-4066-bbb5-d1dc8b84561c&quot;&gt;

**Bonus Issues While investigating**

the celery container is constantly exiting too... something we might need to fix in the future, though our tests don&#39;t rely on celery 

&lt;img width=&quot;819&quot; alt=&quot;Screenshot 2023-08-16 at 18 20 46&quot; src=&quot;https://github.com/Saltus-Partners/oneview/assets/13963732/50dec62f-5b5d-469d-a532-c5676f627f03&quot;&gt;

# TIL - Saltus: How does tech project get prioritised in Saltus?    - 31/Aug/23

Tech-co holds a bi-monthly meeting to talk about all projects and Ashley acts as
a referer to prioritise the projects.

Few criterias are considered for priortisation.

- how easy to do, whether it helps lot of people
- compliance
- cash
- efficiency

Epic becomes important to align with tech-co project.

Creations of dev tickets

1. Post Implementation Checks
2. Tech-co meetting (bi-monthly)
3. Developers Architecting and Spikings 
3. Jira Tickets

# TIL - Saltus: What are the responsibilities of BA in Saltus?      - 31/Aug/23

- define businesse objectives and problem statements
  by working interatively with devs
- (optionally) work with devs on tech architecture
- help with kanban
- QA testing the final tech product

# TIL - Python: fileobj vs string vs byte string                    - 23/Jan/24

- string - &#39;abc&#39; - a sequence of Unicode characters
- byte string - b&#39;abc&#39; - a sequence of octets (integers between 0 and 255)
- fileobj - BytesIO(&#39;abc&#39;) or BytesIO(b&#39;abc&#39;) - an file like object that
  implements `.read()`

# TIL - Python: Profiling in iPython                                - 06/May/24

## ``%%prun -r` returns profiling object

```python
%%prun -D stats

from oneview.models.helpers.imports import pull_accounts_no_threaded
pull_accounts_no_threaded()
</code></pre></div></p>
<div class="highlight"><pre><span></span><code><span class="kn">import</span> <span class="nn">pstats</span>
<span class="kn">from</span> <span class="nn">pstats</span> <span class="kn">import</span> <span class="n">SortKey</span>

<span class="n">stats</span> <span class="o">=</span> <span class="n">pstats</span><span class="o">.</span><span class="n">Stats</span><span class="p">(</span><span class="s1">&#39;stats&#39;</span><span class="p">)</span>

<span class="c1"># `tottime` for the total time spent in the given function (and excluding time</span>
<span class="c1"># made in calls to sub-functions)</span>
<span class="n">stats</span><span class="o">.</span><span class="n">sort_stats</span><span class="p">(</span><span class="s1">&#39;tottime&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">print_stats</span><span class="p">(</span><span class="mi">50</span><span class="p">)</span>
<span class="n">stats</span><span class="o">.</span><span class="n">sort_stats</span><span class="p">(</span><span class="s1">&#39;cumtime&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">print_stats</span><span class="p">(</span><span class="mi">50</span><span class="p">)</span>
<span class="n">stats</span><span class="o">.</span><span class="n">sort_stats</span><span class="p">(</span><span class="s1">&#39;filename&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">print_stats</span><span class="p">(</span><span class="mi">50</span><span class="p">)</span>
</code></pre></div>
<h2 id="alternatively-just-timeit-once">Alternatively, Just timeit once</h2>
<div class="highlight"><pre><span></span><code>%%timeit -n 1 -r 1

from oneview.models.helpers.imports import pull_accounts, pull_accounts_no_threaded
pull_accounts()
</code></pre></div>
<p>See also
- <a href="https://docs.python.org/3/library/profile.html#pstats.Stats.sort_stats">pstat sort keys</a>
- <a href="https://ipython.readthedocs.io/en/stable/interactive/magics.html#magic-prun">%prun documentation</a>
- <a href="https://ipython.readthedocs.io/en/stable/interactive/magics.html#magic-timeit">%timeit documentation</a></p>
<h1 id="til-fish-right-alt-v-to-open-vim-to-edit-command-line-09may24">TIL - Fish: right Alt-v to open vim to edit command line          - 09/May/24</h1>
<p>Notes for the future:</p>
<p>to have <code>alt-v</code> works I need to set the right <code>alt</code> key to be <code>Esc+</code> in iTerm2</p>
<blockquote>
<p>Q: How do I make the option/alt key act like Meta or send escape codes?
A: Go to Preferences &gt; Profiles tab. Select your profile on the left, and then
open the Keyboard tab. At the bottom is a set of buttons that lets you select
the behavior of the Option key. For most users, Esc+ will be the best choice.</p>
</blockquote>
<p>from https://iterm2.com/faq.html</p>
<h1 id="til-django-inheritance-14may24">TIL - Django: inheritance..                                       - 14/May/24</h1>
<p>Django likes subclassing existing class.</p>
<p>RelatedManager subclasses Manager to get all method from managers.</p>
<blockquote>
<p>Create a manager for the reverse side of a many-to-one relation.</p>
<p>This manager subclasses another manager, generally the default manager of
   the related model, and adds behaviors specific to many-to-one relations.</p>
</blockquote>
<p>https://github.com/django/django/blob/a09082a9bec18f8e3ee8c10d473013ec67ffe93b/django/db/models/fields/related_descriptors.py#L675C5-L675C45</p>
<p>Manager is a subclass of QuerySet so that manager has all the methods of
QuerySet.</p>
<blockquote>
<p>class Manager(BaseManager.from_queryset(QuerySet)):
   pass</p>
</blockquote>
<p>https://github.com/django/django/blob/f030236a86a64a4befd3cc8093e2bbeceef52a31/django/db/models/manager.py#L176</p>
<h1 id="til-vim-experimenting-python-vim-module-03jun24">TIL - vim: experimenting python vim module                        - 03/Jun/24</h1>
<p>Quickly </p>
<div class="highlight"><pre><span></span><code><span class="p">:</span><span class="k">py3</span> print<span class="p">(</span><span class="s1">&#39;abc&#39;</span><span class="p">)</span>

# <span class="k">to</span> change <span class="nb">lines</span> <span class="k">in</span> range
<span class="p">:</span><span class="s1">&#39;&lt;,&#39;</span><span class="p">&gt;</span><span class="k">py3do</span> <span class="k">return</span> line.split<span class="p">(</span><span class="s2">&quot;:&quot;</span><span class="p">)</span>[<span class="m">0</span>] <span class="p">+</span> <span class="s1">&#39; = &#39;</span> <span class="p">+</span> line.split<span class="p">(</span><span class="s2">&quot;:&quot;</span><span class="p">)</span>[<span class="m">0</span>].strip<span class="p">()</span> <span class="p">+</span> <span class="s1">&#39;,&#39;</span>

# run foo.<span class="k">py</span> <span class="k">in</span> current <span class="nb">directory</span><span class="p">,</span> have access <span class="k">to</span> <span class="k">all</span> vim_python objects
# see `:help python<span class="p">-</span>command`
<span class="p">:</span><span class="k">pyfile</span> foo.<span class="k">py</span>

# For example
#
# <span class="p">&gt;</span> <span class="k">cat</span> foo.<span class="k">py</span>
# <span class="k">vim</span>.command<span class="p">(</span><span class="s1">&#39;buffers a&#39;</span><span class="p">)</span>
# <span class="k">for</span> <span class="k">b</span> <span class="k">in</span> <span class="k">vim</span>.<span class="k">buffers</span>:
#     print<span class="p">(</span><span class="k">b</span><span class="p">)</span>
#     print<span class="p">(</span><span class="k">b</span>.__dir__<span class="p">())</span>
#     print<span class="p">(</span><span class="k">b</span>.valid<span class="p">)</span>
# visible_buffers <span class="p">=</span> [<span class="nb">window</span>.buffer <span class="k">for</span> <span class="nb">window</span> <span class="k">in</span> <span class="k">vim</span>.current.tabpage.windows]
</code></pre></div>
<h1 id="til-python-requests-library-possible-errors-06jun24">TIL - Python: requests library possible errors                    - 06/Jun/24</h1>
<table>
<thead>
<tr>
<th>error type</th>
<th>safe to retry</th>
<th>examples of when error occurs</th>
</tr>
</thead>
<tbody>
<tr>
<td>HTTPError - 4xx</td>
<td>No</td>
<td>client error, e.g., calling the api incorrectly</td>
</tr>
<tr>
<td>HTTPError - 5xx</td>
<td>No</td>
<td>server error, e.g. bugs in server code</td>
</tr>
<tr>
<td>Connection Error</td>
<td>Maybe</td>
<td>incorrect configurations or unavailble network</td>
</tr>
<tr>
<td>Connection Timeout</td>
<td>Yes</td>
<td>network congestion, server too busy to responds, server being offline</td>
</tr>
<tr>
<td>Request Timeout</td>
<td>Maybe</td>
<td>??</td>
</tr>
<tr>
<td>Requests library Exception</td>
<td>No</td>
<td>data passed in cannot be converted to json</td>
</tr>
<tr>
<td>Other Python Exception</td>
<td>No</td>
<td>any python errors</td>
</tr>
</tbody>
</table>
<p>Note that Request Timeout means <em>The server did not send any data in the
allotted amount of time</em> in <code>Requests</code> library.</p>
<p>https://requests.readthedocs.io/en/latest/api/#requests.ReadTimeout</p>
<h2 id="see-also_1">See also</h2>
<p>https://requests.readthedocs.io/en/latest/api/#exceptions</p>
<h1 id="til-python-search-in-a-python-function-21jun24">TIL - Python: search in a python function                         - 21/Jun/24</h1>
<p>generalised to search within visual selected region</p>
<ol>
<li>visual select a function <code>vaf</code></li>
<li><strong>exit</strong> the visual mode</li>
<li><code>/\%Vfoo</code> to seach in the last visual region (see <code>:help /\%V</code>)</li>
</ol>
<h1 id="til-python-run-black-or-flake8-on-python-code-in-markdown-21jun24">TIL - Python: run black or flake8 on python code in markdown      - 21/Jun/24</h1>
<p>generalised to any files</p>
<ol>
<li><code>vic</code> visual select lines of python codes in markdown code block</li>
<li><code>:'&lt;,'&gt;!black -q -</code> to replace the visually selected lines with the formatted
   standard output of the external <code>black</code> command (see <code>:help filter</code>)</li>
<li><code>:'&lt;,'&gt;w !flake8 -</code> to use <code>w</code> to echo flake8's output instead of replacing
   visually selected lines (see <code>:help :w_c</code>)</li>
</ol>
<p><strong>Alternatively, I can open the output in a split</strong></p>
<ol>
<li><code>:'&lt;,'&gt;w !flake8 - &gt; quickfix.vim</code> to pipe the output into <code>quickfix.vim</code></li>
<li><code>&lt;leader&gt;el</code> </li>
</ol>
<h1 id="til-vim-registers-macros-21jun24">TIL - Vim: Registers &amp; Macros                                     - 21/Jun/24</h1>
<ul>
<li><code>"kp</code> - paste from register k</li>
<li><code>"Kyy</code> - append to register k by using capital register letter <code>K</code></li>
<li>
<p><code>"0p</code> - paste from last yanked test</p>
</li>
<li>
<p><code>qk</code> - start to record macro in register <code>k</code></p>
</li>
<li><code>[count]@k</code> - apply macro in register <code>k</code>, [count] number of times</li>
<li><code>@@</code> - apply last macro</li>
</ul>
<h1 id="til-vim-apply-changes-to-lines-match-a-pattern-21jun24">TIL - Vim: apply changes to lines match a pattern                 - 21/Jun/24</h1>
<ul>
<li><code>:g/foo/d</code> - delete lines with pattern foo in this file, <code>d</code> is the
  abbreviation of <code>:delete</code> command</li>
<li><code>:g/foo/normal Q</code> - apply macro on lines with pattern foo in this file</li>
</ul>
<h1 id="til-vim-vimeval-in-python-vim-21jun24">TIL - Vim: vim.eval in python vim                                 - 21/Jun/24</h1>
<div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">get_import_path_given_word</span><span class="p">(</span><span class="n">vim</span><span class="p">:</span> <span class="nb">object</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
    <span class="n">word</span> <span class="o">=</span> <span class="n">vim</span><span class="o">.</span><span class="n">eval</span><span class="p">(</span><span class="s1">&#39;expand(&quot;&lt;cword&gt;&quot;)&#39;</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">package</span><span class="p">,</span> <span class="n">words</span> <span class="ow">in</span> <span class="n">package_and_word</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="k">if</span> <span class="n">word</span> <span class="ow">in</span> <span class="n">words</span><span class="p">:</span>
            <span class="n">import_string</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;from </span><span class="si">{</span><span class="n">package</span><span class="si">}</span><span class="s2"> import </span><span class="si">{</span><span class="n">word</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">import_string</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">import_string</span>
</code></pre></div>
<p>This function above is used in <code>vim_python.py</code> imported into vim.</p>
<p>The <code>vim.eval</code> literally runs the string passed in as vim code and export the
vim object into python object</p>
<p>For example, the following two vim commands are equivalent.</p>
<p><div class="highlight"><pre><span></span><code>:py3 print(vim.eval(&#39;expand(&quot;&lt;cword&gt;&quot;)&#39;))
:echom expand(&quot;&lt;cword&gt;&quot;)
</code></pre></div>
See also <code>:help if_pyth.txt</code></p>
<h1 id="til-vim-regex-look-ahead-behind-27jun24">TIL - Vim: regex look ahead / behind                              - 27/Jun/24</h1>
<h2 id="find-expression-a-where-expression-b-follows">Find expression A where expression B follows</h2>
<p><code>\@=</code> e.g. <code>\A\(B\)\@=</code></p>
<p>might be easier to use <code>\ze</code></p>
<h2 id="find-expression-a-where-expression-b-does-not-follow">Find expression A where expression B does not follow</h2>
<p><code>\@!</code> e.g. <code>A\(B\)\@!</code></p>
<h2 id="find-expression-a-where-expression-b-is-behind">Find expression A where expression B is behind:</h2>
<p><code>\@&lt;=</code> e.g. <code>\(B\)\@&lt;=A</code></p>
<p>might be easier to use <code>\zs</code></p>
<h2 id="find-expression-a-where-expression-b-is-not-behind">Find expression A where expression B is not behind:</h2>
<p><code>\@&lt;!</code> e.g. <code>\(B\)\@&lt;!A</code></p>
<h2 id="for-example">For example</h2>
<p>"""
foo(
def foo(
"""</p>
<p>to match only function definitions, e.g. the <code>foo</code> after def</p>
<p><code>\(def[ ]\)\@&lt;=foo(</code></p>
<p>to match function usage e.g. the <code>foo</code> not after <code>def</code></p>
<p><code>\(def[ ]\)\@&lt;!foo(</code></p>
<p>"""
foobar
foobaz
"""</p>
<p><code>foo\(bar\)\@=</code> - matches foo that follows with bar e.g. matches first
<code>foo\(bar\)\@!</code> - matches foo that not follows with bar e.g. matches second</p>
<h1 id="til-oneview-graphiql-django-debug-tool-bar-28jun24">TIL - Oneview: GraphIQL + Django Debug Tool Bar                   - 28/Jun/24</h1>
<ol>
<li>login to <code>http://localhost:8000/admin/</code></li>
<li>go to <code>http://localhost:8000/graphql/</code></li>
<li>copy paste both the graphql query and graphql variable from the graphql
   request plugin</li>
<li>run the added query in graphiql</li>
<li>look at the django debug toolbar</li>
</ol>
<h1 id="til-git-rebase-09sep24">TIL - Git Rebase                                                  - 09/Sep/24</h1>
<ul>
<li><code>git rebase -X ours -i origin/development</code><ul>
<li>on merge conflicts, use origin/development</li>
</ul>
</li>
<li><code>git rebase -X theirs -i origin/development</code><ul>
<li>on merge conflicts, use my branch</li>
</ul>
</li>
</ul>
<h1 id="til-quick-start-guide-for-pdb-debugging-20sep24">TIL - quick start guide for pdb debugging                         - 20/Sep/24</h1>
<h2 id="debugging-after-ssh-into-uat">Debugging after ssh into uat</h2>
<p><strong>Prerequisite</strong></p>
<p>Go into the ipython shell e.g. <code>sudo docker exec -it oneview-django poetry run python manage.py shell</code></p>
<div class="highlight"><pre><span></span><code><span class="n">In</span> <span class="p">[</span><span class="mi">1</span><span class="p">]:</span> <span class="kn">from</span> <span class="nn">oneview.graphql.api.charge</span> <span class="kn">import</span> <span class="n">one_fee_calculator</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">2</span><span class="p">]:</span> <span class="n">review_id</span> <span class="o">=</span> <span class="s2">&quot;73a07db5-7214-4ead-a9b8-4906e1727a8c&quot;</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">3</span><span class="p">]:</span> <span class="kn">import</span> <span class="nn">pdb</span>
        <span class="n">pdb</span><span class="o">.</span><span class="n">runcall</span><span class="p">(</span><span class="n">one_fee_calculator</span><span class="p">,</span> <span class="n">review_id</span><span class="p">)</span>
<span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&gt;</span> <span class="o">/</span><span class="n">app</span><span class="o">/</span><span class="n">backend</span><span class="o">/</span><span class="n">oneview</span><span class="o">/</span><span class="n">graphql</span><span class="o">/</span><span class="n">api</span><span class="o">/</span><span class="n">charge</span><span class="o">.</span><span class="n">py</span><span class="p">(</span><span class="mi">248</span><span class="p">)</span><span class="n">one_fee_calculator</span><span class="p">()</span>
<span class="o">-&gt;</span> <span class="n">review</span> <span class="o">=</span> <span class="n">Review</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">review_id</span><span class="p">)</span>
</code></pre></div>
<p>If you do the above, you will be dropped into the pdb debugging shell.</p>
<p>Note: please be careful about possible side effects if the functions called
especially if you are doing this in uat or even prod environment.</p>
<h2 id="pdb">pdb</h2>
<p>pdb is an interactive source code debugger for Python programs.</p>
<p><a href="https://docs.python.org/3/library/pdb.html#module-pdb">pdb</a> is very powerful, though you need to get familiar with the commands</p>
<p>You can find the pdb commands doc 
<a href="https://docs.python.org/3/library/pdb.html#debugger-commands">here</a></p>
<p>Most useful commands I find are</p>
<ul>
<li><code>ll</code> - print all source code for the current function or frame</li>
<li><code>b</code> - breakpoint, you can set breakpoint like so <code>b oneview/graphql/api/charge.py:254</code></li>
<li><code>c</code> - continue, continue until breakpoint</li>
<li><code>n</code> - next, continue execution until the next line</li>
<li><code>s</code> - step, step inside a function</li>
<li><code>sticky</code> - show whole function while you are debugging, make pdb very much
  like debugging with GUI</li>
</ul>
<h1 id="til-event-driven-vs-event-based-architecture-18oct24">TIL - Event Driven v.s. Event Based Architecture                  - 18/Oct/24</h1>
<h2 id="event-driven">Event Driven</h2>
<p>A key feature of true event-driven architectures is that the producers and
consumers are completely decoupled -- a producer shouldn't know or care who is
consuming its events and how the consumers use those events in their service..</p>
<p><strong>Examples</strong></p>
<ul>
<li>Kafka + Kubernetes</li>
<li>IoT + MQTT pub/sub</li>
</ul>
<h2 id="event-based">Event-based</h2>
<p>Two key characteristics of event-based compute</p>
<ol>
<li>the existence of a compute instance is intimately tied to the
occurence of an event to be processed.</li>
<li>the compute acts on a single event at a time.</li>
</ol>
<p><strong>Examples</strong></p>
<ul>
<li>API Gateway + Lambda</li>
</ul>
<p>See also https://www.alexdebrie.com/posts/event-driven-vs-event-based/</p>
<h1 id="til-using-urllib-instead-of-requests-library-for-posting-json-25oct24">TIL - using urllib instead of requests library for posting json   - 25/Oct/24</h1>
<div class="highlight"><pre><span></span><code><span class="n">json_as_bytes</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">payload</span><span class="p">)</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s2">&quot;utf-8&quot;</span><span class="p">)</span>
<span class="n">request_object</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">Request</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">api_url</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">json_as_bytes</span><span class="p">)</span>
<span class="n">request_object</span><span class="o">.</span><span class="n">add_header</span><span class="p">(</span><span class="s2">&quot;Content-Type&quot;</span><span class="p">,</span> <span class="s2">&quot;application/json&quot;</span><span class="p">)</span>
<span class="n">request_object</span><span class="o">.</span><span class="n">add_header</span><span class="p">(</span><span class="s2">&quot;Authorization&quot;</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;Bearer </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">token</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="k">try</span><span class="p">:</span>
    <span class="k">with</span> <span class="n">request</span><span class="o">.</span><span class="n">urlopen</span><span class="p">(</span><span class="n">request_object</span><span class="p">)</span> <span class="k">as</span> <span class="n">response</span><span class="p">:</span>
        <span class="n">res_json</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">read</span><span class="p">())</span>
<span class="k">except</span> <span class="n">HTTPError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
    <span class="n">_logger</span><span class="o">.</span><span class="n">exception</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">code</span><span class="p">)</span>
    <span class="n">_logger</span><span class="o">.</span><span class="n">exception</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">read</span><span class="p">())</span>
    <span class="k">raise</span> <span class="n">e</span>
</code></pre></div>
<p>See Also: https://docs.python.org/3.12/howto/urllib2.html</p>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "..", "features": [], "search": "../assets/javascripts/workers/search.b8dbb3d2.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../assets/javascripts/bundle.ad660dcc.min.js"></script>
      
    
  </body>
</html>